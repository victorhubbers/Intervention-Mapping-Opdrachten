!function(e){function t(t){for(var o,a,s=t[0],c=t[1],l=t[2],u=0,p=[];u<s.length;u++)a=s[u],i[a]&&p.push(i[a][0]),i[a]=0;for(o in c)Object.prototype.hasOwnProperty.call(c,o)&&(e[o]=c[o]);for(d&&d(t);p.length;)p.shift()();return r.push.apply(r,l||[]),n()}function n(){for(var e,t=0;t<r.length;t++){for(var n=r[t],o=!0,s=1;s<n.length;s++){var c=n[s];0!==i[c]&&(o=!1)}o&&(r.splice(t--,1),e=a(a.s=n[0]))}return e}var o={},i={0:0},r=[];function a(t){if(o[t])return o[t].exports;var n=o[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,a),n.l=!0,n.exports}a.m=e,a.c=o,a.d=function(e,t,n){a.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},a.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},a.t=function(e,t){if(1&t&&(e=a(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(a.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)a.d(n,o,function(t){return e[t]}.bind(null,o));return n},a.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return a.d(t,"a",t),t},a.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},a.p="/js/";var s=window.webpackJsonp=window.webpackJsonp||[],c=s.push.bind(s);s.push=t,s=s.slice();for(var l=0;l<s.length;l++)t(s[l]);var d=c;r.push([107,1]),n()}({0:function(e,t,n){var o=n(144),i=n(145)();o.fn.extend({sanitizeHtml:function(e,t){return i.sanitize(e,t)},safeHtml:function(e,t){return null==e?this.html():this.html(this.sanitizeHtml(e,t))},safeAppend:function(e,t){return null==e?this.append(null):this.append(this.sanitizeHtml(e,t))},safeAttr:function(e,t){var n=this.get(0).tagName;return i.isValidAttribute(n,e,t)?this.attr(e,t):this},isSafeURLForNavigation:function(e){return i.isValidAttribute("a","href",e)}}),e.exports=o},100:function(e,t){var n;e.exports={_creds:n={username:null,userid:null,email:null,providerid:null,providerhumanid:null,provider:null,school:null,token:null,sid:null,coaccount:null},credentials:function(){return this._creds},clear:function(){this._creds=n},setCredentials:function(e){this._creds=e},getUserToken:function(){return this._creds.token},getUserSid:function(){return this._creds.sid},getUserName:function(){return this._creds.username},getUserClassName:function(){return this._creds.className},getUserId:function(){return this._creds.userid},getEmail:function(){return this._creds.email},getProviderId:function(){return this._creds.providerid},getProviderHumanId:function(){return this._creds.providerhumanid},isCoAccount:function(){return this._creds.coaccount}}},101:function(e,t){function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}e.exports=function(e){return"string"==typeof(t=e)||"object"===n(t)&&t.constructor===String?0===e.indexOf("http://")||0===e.indexOf("https://")||0===e.indexOf("//")?e.replace(/\(/g,"_").replace(/\)/g,"_").replace(/'/g,"%27"):encodeURIComponent(e).replace(/%2F/g,"/").replace(/'/g,"%27"):"";var t}},102:function(e,t,n){var o=n(44).valueOrCacheValue,i=function(e,t,i,r,a,s,c,l,d,u,p){var f=arguments.length>11&&void 0!==arguments[11]?arguments[11]:n(7),h=arguments.length>12&&void 0!==arguments[12]?arguments[12]:n(247)(),g=arguments.length>13&&void 0!==arguments[13]?arguments[13]:n(253),m=arguments.length>14&&void 0!==arguments[14]?arguments[14]:n(254),w={INIT:-1,ANONYMOUS:0,OFFLINE:1,ONLINE:2},b=t.Deferred(),v=t.Deferred();return w.initialized=function(){return b.resolve(),v},f.getConfig().then(function(n){var a=l.getParameters(),c=u.isLTI(),f=a.sso,y=a.login_hint,k=l.getQueryParams(window.location.search).toplevel,C=c&&!k||a.no_logout||f,x=w.INIT,S=!1;w.stateChangeCallbacks=[],w.registerStateChangeCallback=function(e){this.stateChangeCallbacks.push(e)},w.triggerStateChangeCallbacks=function(){for(var e=[],n=0;n<this.stateChangeCallbacks.length;++n)e.push(this.stateChangeCallbacks[n](x,S));return t.when.apply(null,e)},w.onlinecheck_enabled=!1;var T=null,_=2;function E(){return"no"!==n.support_student_account||u.isLTI()||f}function O(e){return e.firstName&&""!=e.firstName&&e.lastName&&""!=e.lastName?e.firstName+" "+e.lastName:e.firstName&&""!=e.firstName?e.firstName:e.lastName&&""!=e.lastName?e.lastName:e.providerHumanID&&""!=e.providerHumanID&&e.providerHumanID!==e.providerID?e.providerHumanID:e.email&&""!=e.email?e.email.substring(0,e.email.indexOf("@")):e.providerID}w.isStudentAccountsSupported=E,w.setCredentials=function(e,t){var n={username:O(e),userid:e.id,email:e.email,providerid:e.providerID,providerhumanid:e.providerHumanID,provider:e.provider,school:t,className:e.className,token:e.token,sid:null,coaccount:e.isCoAccount};d.setCredentials(n),h.setCredentials(d.credentials())},w.clearCredentials=function(){d.clear(),h.setCredentials(d.credentials())},w.loadCredentials=function(){return t.Deferred(function(e){h.getCredentials().done(function(t){null!==t?d.setCredentials(t):d.clear(),e.resolve(d.credentials())}).fail(function(){console.log("credentials load failure"),d.clear(),e.resolve(d.credentials())})}).promise()},w.getStudentInfo=function(e,o){var i=null,r=null;return null!=e&&""!==e?r={Authorization:"BWWAAuthToken "+e}:null!=o&&""!==o&&(i={sid:o}),t.ajax({type:"GET",dataType:"json",data:i,url:n.student_account_server+"/student/GetInfo",headers:r,timeout:1e4})},w.checkIfOnline=function(){if(!this.onlinecheck_enabled)return t.when();var e=t.Deferred(),n=d.getUserToken();return this.getStudentInfo(n,null).done(function(t){console.log("Got back online !"),w.goOnline(),e.resolve()}).fail(function(){e.reject()}),e},w.goOffline=function(t){console.log("goOffline");var n=this;e.pushAsyncFunc(function(){return console.log("Executing goOffline"),n.setState(w.OFFLINE)})},w.goOnline=function(t){console.log("goOnline");var n=this;e.pushAsyncFunc(function(){return console.log("Executing goOnline"),n.setState(w.ONLINE)})},w.scheduleOnlineCheck=function(){var e=this;_=Math.min(2*_,20),this.onlinecheck_enabled&&(T=setTimeout(function(){e.checkIfOnline().always(function(){e.scheduleOnlineCheck()})},1e3*_))},w.startOnlineCheck=function(){this.onlinecheck_enabled=!0,_=2,this.scheduleOnlineCheck()},w.stopOnlineCheck=function(){this.onlinecheck_enabled=!1,null!==T&&clearTimeout(T)},w.setState=function(e){return e===x?(console.log("Warning: setting identical storage state, ignoring"),t.when()):(x===w.OFFLINE&&this.stopOnlineCheck(),e===w.OFFLINE&&this.startOnlineCheck(),x=e,this.triggerStateChangeCallbacks())},w.setForceOfflineStorage=function(){return!1===S&&(S=!0),this.triggerStateChangeCallbacks()},w.setUserInfo=function(e,t){console.log("Log in successfull"),this.setCredentials(e,t),this.setState(this.ONLINE)},w.waitForExternalLogin=function(e,o){return o=o||2e3,t.Deferred(function(i){var a=null,s=null;var c=g.createPollingUI(function(){a&&clearTimeout(a),s&&s.abort(),l(),i.reject()});function l(){c.close()}!function c(){a=null;var d={sid:e.sid};console.log("Poll",e.sid),s=t.ajax({type:"GET",dataType:"json",data:d,url:n.student_account_server+"/student/GetInfo",timeout:1e4,success:function(e){s=null,l(),i.resolve(e)},error:function(e,t,n){if(s=null,"abort"!==t)if(401===e.status||0===e.status)try{0===e.status||"authenticating"===JSON.parse(e.responseText).auth.status?a=setTimeout(c,o):(l(),i.reject({msg:r("Authentication error.")}))}catch(e){l(),i.reject({msg:r("Server error when signing in.")})}else l(),i.reject({msg:r("Received error trying to sign in")+" ("+e.status+")"})}})}()}).promise()},w.serverLogin=function(e,o,i){return t.Deferred(function(a){var s={schoolCode:e,username:o,password:i};return t.ajax({type:"POST",data:s,url:n.student_account_server+"/student/Login",timeout:1e4}).done(function(e){a.resolve(e)}).fail(function(e){401==e.status?a.reject({msg:r("Wrong username or password, please try again.")}):a.reject({msg:r("Received error trying to sign in")+" ("+e.status+")"})})}).promise()},w.login=function(e,n,o){var i=this;return t.Deferred(function(t){"oauth"===n||"signup"===o.action?i.waitForExternalLogin(e).done(function(e){t.resolve(e)}).fail(function(e){t.reject(e)}):"login"===o.action?i.serverLogin(o.school,o.username,o.password).done(function(e){t.resolve(e,o.school)}).fail(function(e){t.reject(e)}):t.reject({msg:"Unsupported login action"})}).promise()},w.getLoginCredentials=function(e,n){return t.Deferred(function(t){"oauth"===n?t.resolve(e,n):"bw"===n?g.queryBWCredentials(e).done(function(o){t.resolve(e,n,o)}).fail(function(e){t.reject(e)}):"school"===n?g.querySchoolCredentials(e).done(function(o){t.resolve(e,n,o)}).fail(function(e){t.reject(e)}):t.reject({msg:"Unsupported login type: "+n})}).promise()},w.hasSchool=function(){return n.hasOwnProperty("student_account_school")&&n.student_account_school.hasOwnProperty("code")&&null!==n.student_account_school.code&&""!==n.student_account_school.code&&"null"!==n.student_account_school.code},w.selectLoginType=function(e){var n=this;return t.Deferred(function(t){if(e.oauth_links.length>0||!n.hasSchool()){if(f)for(var o=0;o<e.oauth_links.length;++o){var a=e.oauth_links[o];if(a.provider===f)return void i.navigateAlert(r("You need to be signed in to use this widget."),r("Please sign in"),r("OK"),a.url)}g.queryLoginMethod(e).done(function(n){t.resolve(e,n)}).fail(function(e){t.reject(e)})}else t.resolve(e,"school")}).promise()},w.getLoginInfo=function(){var e=a.lfq?l.split(a.lfq):{};e.schoolCode=this.hasSchool()?n.student_account_school.code:"",f?e.providers=f:n.student_account_authrestrict&&"yes"===n.student_account_authrestrict&&(e.providers=(n.student_account_authproviders||[]).join(",")),e.source=function(e){var t=s.getPlatform();return"ibw-platform-ipad-ibooks"===t||"ibw-platform-ipad-ibooks-epub"===t?"ibooks-ios":"ibw-platform-ipad-bookwidgets"===t?s.isPreview()?"bwapp-preview":"bwapp":"ibw-platform-osx-ibooks"===t||"ibw-platform-osx-ibooks-epub"===t?"ibooks-osx":"ibw-platform-osx-preview"===t||"ibw-platform-win32-preview"===t?"bw-preview":"ibw-platform-android-chrome"!==t||e?s.isPreview()?"create-preview":s.isTopLevelPlay()?"play":"embed":"embed"}(!!f),n.kmuserid&&""!=n.kmuserid&&(e.creator=n.kmuserid),"undefined"!=typeof bwshortcode&&(e.widget=bwshortcode),s.isIOS()&&(e.ios="1"),e.q=o(a.q);var i=m("body");return t.Deferred(function(o){t.ajax({type:"GET",dataType:"json",data:e,url:n.student_account_server+"/student/GetLoginForm",timeout:1e4}).done(function(e){i.close(),o.resolve(e)}).fail(function(e){i.close(),400==e.status?o.reject({msg:r("Widget configuration error: school doesn't exist.")}):o.reject({msg:r("Could not connect to server, check your internet connection.")})})}).promise()},w.reportFailure=function(e){return e&&e.hasOwnProperty("msg")?g.showMessage(e.msg,r("Sign in failed")):t.when(!0)},w.requestSignin=function(){var e=this;return t.Deferred(function(t){e.getLoginInfo().then(e.selectLoginType.bind(e)).then(e.getLoginCredentials.bind(e)).then(e.login.bind(e)).then(e.setUserInfo.bind(e)).then(function(){t.resolve(!1)}).fail(function(n){e.reportFailure(n).done(function(e){t.resolve(!e)})})}).promise()},w.showLoginStateInfo=function(){return x===w.OFFLINE?g.queryLogout(r("Offline"),r("You're currently offline and logged in as user:"),this.getUserName(),C):x===w.ONLINE?g.queryLogout(r("Online"),r("You're currently online and logged in as user:"),this.getUserName(),C):t.when()},w.loopLoginUntilOnline=function(e){var t=this;this.requestSignin().done(function(n){x===t.ONLINE?e.resolve():n?t.loopLoginUntilOnline(e):g.showMessage(r("You need to be signed in to use this widget."),r("Please sign in")).done(function(){t.loopLoginUntilOnline(e)})})},w.forceLogin=function(){var e=t.Deferred();return this.loopLoginUntilOnline(e),e},w.setAnonymousOrForceLogin=function(){u.isEmbeddedLTI()?this.loginLTI():"optional"===n.support_student_account?(this.setState(this.ANONYMOUS),v.resolve()):this.forceLogin().done(function(){v.resolve()})},w.initializeWithStoredCredentials=function(e){var t=this,o=e.token,i=e.sid,r=null!=o&&""!==o;if(!1===r&&!1===(null!=i&&""!==i)||E()&&this.hasSchool()&&n.student_account_school.code!==e.school)this.setAnonymousOrForceLogin();else{var a=m("body");t.getStudentInfo(o,i).done(function(n){if(a.close(),f&&!i&&(n.provider!==f||!y||0==y.length||n.providerID!==y&&n.providerHumanID!==y))return console.log("Logged in with incompatible credentials. Re-login."),void t.setAnonymousOrForceLogin();t.setCredentials(n,e.school),t.setState(w.ONLINE),v.resolve()}).fail(function(e){a.close(),console.log("Error getting student info -> either invalid token or wrong connection"),r&&401!==e.status?(t.setState(w.OFFLINE),v.resolve()):t.setAnonymousOrForceLogin()})}},w.loginLTI=function(){var e=m("body"),o=this;t.ajax({type:"POST",data:{lti:l.urlencode(l.getParameters()),url:window.location.protocol+"//"+window.location.host+window.location.pathname,wa:n.WA,id:n.uuid2},headers:p.getAJAXHeaders(),url:n.student_account_server+"/student/Login",timeout:1e4}).then(function(t){e.close(),u.setEmbeddedLTIAuthenticated(),o.setCredentials(t,null),o.setState(w.ONLINE),v.resolve()},function(t){e.close();try{var n=JSON.parse(t.responseText);if("noLTILicense"==n.code)return o.setState(o.ANONYMOUS),void v.reject();if(null!=n.message&&n.message.length>0)return void i.showFatalAlert(n.message,r("Error"))}catch(e){}0===t.readyState?i.showFatalAlert(r("You need an internet connection to access this widget."),r("Error")):i.showFatalAlert(r("Error signing in."),r("Error"))})},w.initialize=function(){var e=this;t(function(){if(!E())return e.setState(e.ANONYMOUS),void v.resolve();var t=a.sid;return t?(console.log("Got SID from params"),history.replaceState("",document.title,window.location.pathname+window.location.search+l.removeQueryStringParameter(l.getHash(),"sid")),void e.initializeWithStoredCredentials({sid:t})):!u.isEmbeddedLTI()||u.isEmbeddedLTIAuthenticated()?!c&&s.isPreview()?(e.setState(e.ANONYMOUS),void v.resolve()):void e.loadCredentials().done(e.initializeWithStoredCredentials.bind(e)):void e.loginLTI()})},b.then(function(){w.initialize()}),w.logout=function(){return this.clearCredentials(),"optional"===n.support_student_account?this.setState(w.ANONYMOUS):(m("body"),window.location.reload(!1)),t.when().promise()},w.requestSignout=function(){return this.showLoginStateInfo().done(this.logout.bind(this))},w.getUserToken=function(){return d.getUserToken()},w.getUserSid=function(){return d.getUserSid()},w.getUserName=function(){return d.getUserName()},w.getUserClassName=function(){return d.getUserClassName()},w.getUserId=function(){return d.getUserId()},w.getEmail=function(){return d.getEmail()},w.getProviderId=function(){return d.getProviderId()},w.getProviderHumanId=function(){return d.getProviderHumanId()},w.isCoAccount=function(){return d.isCoAccount()},w.getState=function(){return x},w.getForceOfflineStorage=function(){return S},w.hasProperty=function(e){return"user_id"===e},w.getProperty=function(e){if("user_id"==e)return this.getUserId()}}),w}.bind(null,n(105),n(0),n(21),n(11),n(104),n(2),n(35),n(8),n(100),n(55),n(255));e.exports={f:i,o:i()}},103:function(e,t,n){var o=n(54).map;e.exports={url:function(e,t){var n="js2objc://"+e;return t&&(n+="?"+o(t,function(e,t){return encodeURIComponent(t)+"="+encodeURIComponent(e)}).join("&")),n}}},104:function(e,t,n){var o;e.exports=(o=n(0),function(e,t,n,i){var r=i&&""!==i?"onclick=\"setTimeout(function() { parent.postMessage({ msg:'"+i+"'}, '*');}, 1000);\" ":"",a=document.createElement("iframe");a.className="bwexternallink";var s='<body style="margin: 0px"><a style="display: block; width: 100%; height: 100%; background:red;" '+r+'href="'+t+'" target="_blank">&nbsp;</a></body>';e.appendChild(a),a.contentWindow.document.open(),a.contentWindow.document.write(s),a.contentWindow.document.close(),o(a).css({position:"absolute",left:0,top:0,width:"100%",height:"100%"})})},105:function(e,t,n){e.exports=function(e){var t={},n=null,o=[];function i(){0!=o.length?(n=o.shift())():n=null}return t.pushAsyncFunc=function(t){var r=e.Deferred();return o.push(function(){t().always(function(){r.resolve(),i()})}),null===n&&i(),r},t.pushSyncFunc=function(t){this.pushAsyncFunc(function(){return t(),e.when()})},t}(n(0))},107:function(e,t,n){var o,i,r,a,s,c,l,d,u,p,f,h,g,m,w,b,v;n(108),e.exports=(o=n(7),i=n(83),r=n(237),a=n(238),s=n(62),c=n(240),l=n(35),d=n(60),u=n(0),p=n(101),f=n(56),h=n(246),g=n(61),m=n(102).o,w=n(256),b=n(257),v=n(11),void u(function(){return o.getConfig().then(function(e){l.makeWidget({"no-user-select":!0});var t,n,o,y=b(),k=e.hotspots||[],C=y.registerSet("hotspots",v("Hotspots accessed"),v("Hotspot accesses"),k.length);function x(){u(".popup").addClass("hidden"),u(".triangle").remove(),u("video").each(function(){this.pause()})}function S(e,t,n){console.log("Creating audio: "+e);var o=a.addElement(e,n);t.tapOrClick(function(){C.registerAccess(u(this).attr("id")),!0===o.paused()?o.play():o.pause()})}function T(e,t){t.tapOrClick(function(){g.openLinkOrWidgetLink(e,!0)})}function _(e,t){var n=t.find(".popupcontent"),o=t.attr("id");n.safeHtml(r.prepare(e.text)),i.process(n),s.resolveYoutubePlaceholders(n),a.processAudioTags("#"+o),r.processMathElems(n);var c=u.Deferred();return r.schedule(c.resolve.bind(c)),c}function E(e,t){t.find(".popupcontent").append(u(document.createElement("img")).attr("src",p(e.image)))}function O(e,t){var n=t.find(".popupcontent"),o=""!==e.width?e.width:null,i=""!==e.height?e.height:null;s.createHtml5VideoPlayer(e.video,o,i).appendTo(n)}function I(e,t){var n=t.find(".popupcontent"),o={};""!==e.width&&(o.width=e.width),""!==e.height&&(o.height=e.height),n.append(u(document.createElement("div")).addClass("webpopup").attr(o).append(u(document.createElement("iframe")).safeAttr("src",f(e.url)).attr(o)))}void 0===e.support_student_account&&alert("Incorrect schema.xml, must include studentaccountconfig.xml if widget depends on widgetstorage.js"),m.isStudentAccountsSupported()&&w.init(),u("#container").css("background","#FFF2F1 url("+p(e.background_picture)+") no-repeat center center"),"Cover entire area, keep aspect ratio"===e["resize-policy"]?u("#container").css("background-size","cover"):"Contain entire picture, keep aspect ratio"===e["resize-policy"]?u("#container").css("background-size","contain"):"Cover entire area with entire picture"===e["resize-policy"]&&u("#container").css("background-size","100% 100%"),u(document.createElement("div")).attr("id","hotspots").appendTo(u("#container")),u(document.createElement("div")).attr("id","popups").appendTo(u("#container"));for(var P=0;P<k.length;++P){var A,L=k[P],N="popup_"+P,M="hotspot_"+P,B=u(document.createElement("div")).addClass("hotspot").attr({id:M,popupid:N,type:L.Type}).appendTo(u("#hotspots"));"image"===L["marker-type"]?(B.addClass("image"),A=u(document.createElement("div")).addClass("content").append(u(document.createElement("img")).attr("src",p(L["marker-image"]))).appendTo(B)):"label"===L["marker-type"]?(B.addClass("label"),A=u(document.createElement("div")).addClass("content").safeHtml(L["marker-label"]).appendTo(B)):(B.addClass("none"),A=B);var U=u(document.createElement("div")).attr({id:N,hotspotid:M}).addClass("popup hidden").appendTo(u("#popups")),R=u(document.createElement("div")).addClass("popupcontent").appendTo(U);"AudioPopup"===L.Type?L.audiofile&&""!==L.audiofile&&S(L.audiofile,A,R):"WebLink"===L.Type?T(L.url,A):"ImagePopup"===L.Type?(E(L,U),U.attr("initialised","yes")):U.data("hotspot",JSON.stringify(L)),U.css({left:L.position.X+"px",top:L.position.Y+"px"}),"AudioPopup"!==L.Type&&"WebLink"!==L.Type&&(B.attr("popup-location",L["popup-location-preference"]),A.tapOrClick(function(e){e.stopPropagation(),C.registerAccess(u(this).attr("id"));var t=u(this);t.hasClass("hotspot")||(t=t.parent());var n=u("#"+t.attr("popupid"));function o(){var e=u("body").width(),o=u("body").height(),i=u("#container").width(),r=u("#container").height();i>e&&(e=i),r>o&&(o=r);var a,s,c,l,d=u("#container").position().left,p=u("#container").position().top,f=t.find(".content");f.length>0?(c=f.width(),l=f.height(),a=t.position().left,s=t.position().top):(c=t.width(),l=t.height(),a=t.position().left+c/2,s=t.position().top+l/2),h.positionPointerPopup(25,n,{x:t.position().left,y:t.position().top,width:c,height:l,centerx:a,centery:s},d,p,e,o,t.attr("popup-location"),n.parent())}if("yes"!==n.attr("initialised")){var i=JSON.parse(n.data("hotspot"));"TextPopup"===i.Type?_(i,n).then(o):"ImagePopup"===i.Type?E(i,n):"VideoPopup"===i.Type?O(i,n):"WebPopup"===i.Type&&I(i,n),n.attr("initialised","yes")}x(),setTimeout(o,0)}))}t=function(){var t,i,r,a,s=u("body").width(),c=u("body").height();if("Image draggable and resizeable"===e["resize-policy"]){var l=u("#container").width(),p=u("#container").height();r=0,a=0,t=l/n,i=p/o}else{u("#container").css({width:s,height:c});var f=d.calculateScaleAndOffset(e["resize-policy"],s,c,n,o);t=f.scale_x,i=f.scale_y,r=f.offset_x,a=f.offset_y}function h(e){return r+e*t}function g(e){return a+e*i}for(var m=0;m<k.length;++m){var w=k[m],b=u("#hotspot_"+m);"label"===w["marker-type"]||"image"===w["marker-type"]?b.css({left:h(w.point.x)+"px",top:g(w.point.y)+"px"}):b.css({left:h(w.position.X)+"px",top:g(w.position.Y)+"px",width:w.position.Width*t+"px",height:w.position.Height*i+"px"});var v=b.find(".content");v.length>0&&v.css({left:(b.width()-v.outerWidth())/2,top:(b.height()-v.outerHeight())/2})}},d.getImageSize(e.background_picture,function(i,r){if(n=i,o=r,"Image draggable and resizeable"===e["resize-policy"]){u("#container").css({position:"absolute",left:"0",top:"0",width:n+"px",height:o+"px","background-size":"contain"}),c.bwMakeDragAndResizable(u("#container"),u("#zoomin"),u("#zoomout"),void 0,function(){x(),t()});var a=e.position;if(""!==a.X&&""!==a.Y&&""!==a.Width&&""!==a.Height){var s=parseInt(a.X),l=parseInt(a.Y);if(i=parseFloat(a.Width),r=parseFloat(a.Height),i>0&&r>0){var d=u(window).width(),p=u(window).height(),f=d/i,h=p/r,g=f<h?f:h;u("#container").width(n*g),u("#container").height(o*g);var m=d/2-(s+i/2)*g,w=p/2-(l+r/2)*g;u("#container").css("left",m),u("#container").css("top",w)}}u("#tools").removeClass("hidden")}t()}),window.onresize=t,u("#container").tapOrClick(function(e){(e.gesture&&e.gesture.target===u("#container")[0]||!e.gesture&&e.target===u("#container")[0])&&x()}),window.widget||(window.widget=[]),l.pauseAudioVisual=function(){x()}}),null}))},108:function(e,t,n){"use strict";n.r(t);n(109),n(134),n(136),n(140),n(142)},11:function(e,t,n){e.exports=(n(7),function(e){try{return window.bwlocalizationmap&&window.bwlocalizationmap[e]&&""!==window.bwlocalizationmap[e]?window.bwlocalizationmap[e]:e}catch(t){return e}})},143:function(e,t,n){"use strict";n.r(t);var o=n(0),i=n(8),r=n(146),a=r.loadJS,s=r.loadCSS,c=!1,l=!1,d=new RegExp("https://www.bookwidgets.com/create/api/widgets/[0-9]+/preview/config.(css||js)?");function u(e){return 0===window.location.pathname.indexOf("/_ah/gcs/bookwidgets-eu--widgets/")?window.location.origin+"/_ah/gcs/bookwidgets-eu--widget-assets"+e:window.location.host.startsWith("widgets-eu.")?0===e.search(d)?e:window.location.host.replace("widgets-eu.","//widget-assets-eu.")+e:e}t.default=function(){var e=i.split(window.location.search.substring(1));e.dbg5&&n(147)({apiKey:e.dbg5,autoCaptureSessions:!1,notifyReleaseStages:["production"],releaseStage:"production"});var t=o.Deferred();if(!1===l&&!1===c){c=!0;var r=u(e.content)||"config.js",d=u(e.design)||"config.css";o.when(a(r),s(d)).fail(function(){t.reject(new Error("Unable to load config file"))}).always(function(e,n){n&&o(n).attr("id","designconfig"),c=!1,l=!1;var i=window.widgetconfig;t.resolve(i),-1===navigator.userAgent.indexOf("ibookwidgets")&&(window.widgetconfig=void 0)})}return t}},144:function(e,t){e.exports=window.$},146:function(e,t,n){var o=n(0);e.exports={loadJS:function(e,t,n){var i=o.Deferred(),r=document.createElement("script");if(r.setAttribute("type","text/javascript"),n){var a=!0,s=!1,c=void 0;try{for(var l,d=n[Symbol.iterator]();!(a=(l=d.next()).done);a=!0){var u=l.value;r.setAttribute(u,n[u])}}catch(e){s=!0,c=e}finally{try{a||null==d.return||d.return()}finally{if(s)throw c}}}return r.onload=function(){i.resolve()},r.onerror=function(){window.navigator&&window.navigator.userAgent&&-1===window.navigator.userAgent.indexOf("PhantomJS")&&-1===window.navigator.userAgent.indexOf("HeadlessChrome")&&console.error("Could not load: "+e),i.reject()},r.setAttribute("src",e),document.getElementsByTagName(t||"head")[0].appendChild(r),i},loadCSS:function(e,t){var n=o.Deferred(),i=document.createElement("link");return i.setAttribute("rel","stylesheet"),i.setAttribute("type","text/css"),i.onload=function(){n.resolve(i)},i.onerror=function(){window.navigator&&window.navigator.userAgent&&-1===window.navigator.userAgent.indexOf("PhantomJS")&&-1===window.navigator.userAgent.indexOf("HeadlessChrome")&&console.error("Could not load: "+e),n.reject()},i.setAttribute("href",e),document.getElementsByTagName(t||"head")[0].appendChild(i),n}}},149:function(e,t,n){e.exports=function(e){var t=[];window.activateDesignInfoTooltips=function(){console.log("activateDesignInfoTooltips");var n=!0;e.each(t,function(t,o){var i=e(o[0]),r="n";i.height()>700?r=i.offset()&&i.offset().left>800?"e":"w":i.offset()&&i.offset().top>700&&(r="s"),i.attr("data-tipsy",o[1]).tipsy({html:!0,title:"data-tipsy",gravity:r}),e(o[0]).click(function(e){void 0!==window.previewsidebar&&n&&(window.previewsidebar.setSelectedItem(o[1]),n=!1,setTimeout(function(){n=!0},100))})})};var n=[],o=!1;var i=!1;window.BwNotifyWidgetLoaded=function(){i||(i=!0,window.parent.postMessage("BwWidgetLoaded","*"),window.clientApp&&window.clientApp.widgetLoaded&&window.clientApp.widgetLoaded())};var r=!0;function a(){for(;n.length>0;){n.shift()()}r&&window.BwNotifyWidgetLoaded()}return window.BwUseManualWidgetLoadedNotification=function(){r=!1},function(i){if("bwshortcode"in i&&(window.bwshortcode=i.bwshortcode),"pre"in i&&(console.log("Preview"),"designinfo"in i)){console.log("With design info");for(var r=0;r<i.designinfo.length;++r)s=i.designinfo[r].s,c=i.designinfo[r].d,t.push([s,c]);"undefined"!=typeof previewsidebar&&(console.log("Previewsidebar is defined, immediately set design config"),e(function(){var e;e=function(){window.CssUpdateCounter&&(console.log("has CssUpdateCounter -> updating configCss"),window.updateConfigCSS(window.CssUpdateCounter)),console.log("Activating tooltips"),setTimeout(function(){window.activateDesignInfoTooltips()},3e3)},o?setTimeout(e,0):n.push(e)}))}var s,c;if("bra"in i&&e(function(){"iPad"===navigator.platform&&-1!==navigator.userAgent.indexOf("BookWidgets")||e(document.createElement("div")).addClass("branding").appendTo("body")}),"tri"in i&&e(function(){if("iPad"===navigator.platform||-1===navigator.userAgent.indexOf("BookWidgets")&&-1===navigator.userAgent.indexOf("ibookwidgets")){e(document.createElement("div")).addClass("dialog-sheet").attr("id","preview_alert").css({color:"red","text-shadow":"none"}).append(e(document.createElement("p")).safeHtml("This is a free preview widget, created using a trial version of BookWidgets. <b>This widget may only be used for demonstration and evaluation purposes!</b>")).append(e(document.createElement("p")).text("Please purchase a license key for the BookWidgets tool to remove this message.")).appendTo("body");var t=e(document.createElement("div")).addClass("dialog-sheet-shadow");e(document.body).append(t),window.CreateDialogSheetFor("#preview_alert"),setTimeout(function(){e("#preview_alert").data("dialogSheet").show()},2e3),setTimeout(function(){e("#preview_alert").data("dialogSheet").hide()},6e3),setTimeout(function(){e("#preview_alert").data("dialogSheet").show()},3e4),setTimeout(function(){e("#preview_alert").data("dialogSheet").hide()},34e3)}}),void 0===String.prototype.trim&&(String.prototype.trim=function(){return String(this).replace(/^\s+|\s+$/g,"")}),window.getWidgetUrl=function(){return window.location.href},window.bwbackbuttonlabel=null,"performance"in window==!1&&(window.performance={}),"now"in window.performance==!1){var l=Date.now();window.performance.timing&&window.performance.timing.navigationStart&&(l=window.performance.timing.navigationStart),window.performance.now=function(){return Date.now()-l}}return i.hasOwnProperty("backbutton_label")&&""!==i.backbutton_label&&(window.bwbackbuttonlabel=i.backbutton_label),"Vertical"===i.widget_orientation?e("html").addClass("vertical"):e("html").addClass("horizontal"),null!=i.widget_language&&""!==i.widget_language&&e("html").attr("lang",i.widget_language),i.hasOwnProperty("LocalizationMap")&&(window.bwlocalizationmap=i.LocalizationMap),setTimeout(a,0),null}}(n(0))},2:function(e,t,n){e.exports=function(e){function t(){var e=window.navigator.userAgent,t=e.indexOf("OS ");return(e.indexOf("iPhone")>-1||e.indexOf("iPad")>-1)&&t>-1?window.Number(e.substr(t+3,3).replace("_",".")):0}function n(){return window.BW_PLATFORM_HACK?window.BW_PLATFORM_HACK:"iPad"===navigator.platform||"iPhone"===navigator.platform?void 0!==navigator.epubReadingSystem&&"iBooks"===navigator.epubReadingSystem.name?"ibw-platform-ipad-ibooks-epub":-1!==navigator.userAgent.indexOf("Safari")?"ibw-platform-ipad-safari":-1!==navigator.userAgent.indexOf("BookWidgets")?"ibw-platform-ipad-bookwidgets":"http:"!==window.location.protocol&&"https:"!==window.location.protocol?"ibw-platform-ipad-ibooks":"ibw-platform-ipad":"MacIntel"===navigator.platform?void 0!==navigator.epubReadingSystem&&"iBooks"===navigator.epubReadingSystem.name?"ibw-platform-osx-ibooks-epub":-1!==navigator.userAgent.indexOf("PhantomJS")?"ibw-platform-osx-phantomjs":-1!==navigator.userAgent.indexOf("HeadlessChrome")?"ibw-platform-osx-headlesschrome":-1!==navigator.userAgent.indexOf("ibookwidgets")?"ibw-platform-osx-preview":-1!==navigator.userAgent.indexOf("Chrome")?"ibw-platform-osx-chrome":-1!==navigator.userAgent.indexOf("Safari")?"ibw-platform-osx-safari":-1!==navigator.userAgent.indexOf("Firefox")?"ibw-platform-osx-firefox":"http:"!==window.location.protocol&&"https:"!==window.location.protocol?"ibw-platform-osx-ibooks":"ibw-platform-osx":"Win32"===navigator.platform?-1!==navigator.userAgent.indexOf("BookWidgets")?"ibw-platform-win32-preview":"Microsoft Internet Explorer"===navigator.appName||"Netscape"===navigator.appName&&-1!==navigator.userAgent.indexOf("Trident")||"Netscape"===navigator.appName&&-1!==navigator.userAgent.indexOf("Edge")?"ibw-platform-win32-ie":-1!==navigator.userAgent.indexOf("Chrome")?"ibw-platform-win32-chrome":"Microsoft Internet Explorer"===navigator.appName?"ibw-platform-win32-ie":-1!==navigator.userAgent.indexOf("Firefox")?"ibw-platform-win32-firefox":"ibw-platform-win32":"iPad Simulator"===navigator.platform||"iPhone Simulator"===navigator.platform?"ibw-platform-ipad-bookwidgets":-1!==navigator.userAgent.indexOf("Android")?-1!==navigator.userAgent.indexOf("Chrome")?"ibw-platform-android-chrome":"ibw-platform-android":-1!==navigator.userAgent.indexOf("CrOS")?-1!==navigator.userAgent.indexOf("Chrome")?"ibw-platform-chromebook-chrome":"ibw-platform-chromebook":"ibw-platform-unknown"}return{getPlatform:n,supportsAppFeature:function(e){var t=/BookWidgets\/([0-9]+)\.([0-9]+)\.([0-9]+)/g.exec(navigator.userAgent),n=t&&4===t.length?1e4*parseInt(t[1])+100*parseInt(t[2])+parseInt(t[3]):0;return console.log(e+" "+n),"audiorecording"===e&&n>=20800},isToolPreview:function(){return-1!==this.getPlatform().indexOf("preview")},isWebPreview:function(){return"1"===e.getUrlParams(window.location.href).preview},isPreview:function(){return this.isToolPreview()||this.isWebPreview()},isTopLevelPlay:function(){return"1"===e.getUrlParams(window.location.href).toplevel},usesCredentialProxy:function(){return-1!==window.location.search.substring(1).indexOf("bwds-secure-proxy")},isAndroidIosDevice:function(){var e=n();return 0===e.indexOf("ibw-platform-ipad")||0===e.indexOf("ibw-platform-android")},isTouchDevice:function(){return this.isAndroidIosDevice()||(t=" -webkit- -moz- -o- -ms- ".split(" "),"ontouchstart"in window||(e=["(",t.join("touch-enabled),("),"heartz",")"].join(""),window.matchMedia(e).matches));var e,t},isIOS:function(){return"iPad"===navigator.platform||"iPhone"===navigator.platform},isInternetExplorer:function(){return-1!==window.navigator.userAgent.indexOf("MSIE ")||/rv:11.0/i.test(window.navigator.userAgent)},getIOSIBooksRestartInfo:function(){return t()>=7?'To close iBooks:<ol style="text-align: left;"><li>Double-click the Home button.</li><li>Swipe left or right until you have located iBooks.</li><li>Swipe the app\'s preview up to close it.</li></ol>':t()>=5?"To close iBooks:<ol style=\"text-align: left;\"><li>Double-click the Home button.</li><li>Touch-and-hold the iBooks icon to put it into 'jiggly mode'.</li><li>Tap the red minus-sign icon that appears at the top left corner of iBooks.</li><li>Click the Home button to exit 'jiggly mode'.</li></ol>":""},inIframe:function(){try{return window.self!==window.parent}catch(e){return!0}}}}(n(8))},21:function(e,t,n){e.exports=function(e,t){function n(n,o,i,r,a){a=a||a+" custom_alert",i=i||e("Ok"),o=o||"Alert",n=n||"No Message to Display";var s=t(document.createElement("div")),c={};return c[i]=function(){t(this).dialog("close"),t(this).remove(),r&&r()},s.safeHtml(n).dialog({title:o,dialogClass:"bw-dialog no-close "+a,resizable:!1,modal:!0,width:"auto",buttons:c}),s}return{showAlert:n,navigateAlert:function(e,o,i,r){var a=n(e,o,i,function(){});return a.parent().find("button").replaceWith(t(document.createElement("a")).safeHtml(i).attr({href:r,target:"_top"}).addClass("ui-button")),a},showCriticalAlert:function(e,o){var i={message:e,title:o};function r(){n(i.message,i.title)}0===t("#critical-alert-button").length&&t(document.createElement("div")).attr("id","critical-alert-button").addClass("bw-toolbutton").append(t(document.createElement("div")).addClass("bw-icon bw-icon-critical-error")).prependTo(t("#title-toolbar")).click(r),r()},showFatalAlert:function(e,n){t(document.createElement("div")).safeHtml(e).dialog({title:n,dialogClass:"bw-dialog no-close",resizable:!1,modal:!0,width:"auto"})},showConfirmationDialog:function(e,n,o,i,r,a){n||(n="Please confirm"),e||(e=""),r||(r="OK"),a||(a="Cancel"),t("#BwConfirmationDalog").remove();var s=t(document.createElement("div")).attr("id","BwConfirmationDialog"),c={};return c[r]=function(){t(this).dialog("close"),t(this).remove(),o&&o()},c[a]=function(){t(this).dialog("close"),t(this).remove(),i&&i()},s.safeHtml(e).dialog({title:n,dialogClass:"bw-dialog BwConfirmationDialog no-close",resizable:!1,modal:!0,width:500,buttons:c}),s},showInfoMessage:function(e){console.log("ShowInfoMessage");var n=t(document.createElement("div"));function o(){n.removeClass("bw-dialog-animate-in").addClass("bw-dialog-animate-out"),setTimeout(function(){n.remove()},500)}n.safeHtml(e).addClass("bw-dialog bw-info-dialog bw-dialog-animate-in").click(function(e){e.stopPropagation(),o()}).appendTo(t("body")),setTimeout(o,1e4)}}}(n(11),n(0))},235:function(e,t,n){"use strict";n.r(t),n.d(t,"processEmbeddedIframes",function(){return a});var o=n(62),i=n(0);function r(e){e.attr("src").toLowerCase().endsWith("mp4")?function(e){e.replaceWith(o.createHtml5VideoPlayer(e.attr("src")))}(e):function(e){var t=["allow-forms","allow-modals","allow-pointer-lock","allow-popups","allow-popups-to-escape-sandbox","allow-same-origin","allow-scripts"];null!=document.hasStorageAccess&&t.push("allow-storage-access-by-user-activation");try{e.attr({allow:"microphone",sandbox:t.join(" ")})}catch(e){console.log()}}(e)}function a(e){e.each(function(){r(i(this))})}},236:function(e,t,n){},237:function(e,t,n){var o,i,r,a,s;e.exports=(o=n(7),i=n(2),r=n(0),a=n(57),s={},window.BWMATH=s,s.disabled=!1,s.nextUniqueId=1,s.queue=[],s.customCssClasses=[],s.initialized=!1,s.initialize=function(){if(!1===this.initialized&&-1!==i.getPlatform().indexOf("chrome")){var e=r(document.createElement("div")).attr("id","chromemathjaxhack").css({position:"absolute","pointer-events":"none"}).prependTo(r("body")),t=r(document.createElement("canvas")).attr({width:300,height:300}).appendTo(e)[0];t.getContext("2d").clearRect(0,0,t.width,t.height),this.initialized=!0}},s.prepare=function(e){if(this.disabled)return e;var t="",n=0,o=e.indexOf("$$"),i=0;for(o>=0&&this.initialize();o>=0&&!(++i>1e4);){t+=e.substring(n,o);var r=e.indexOf("$$",o+2);if(r<0){n=o;break}t+='<span class="bwmathquill" style="direction:ltr; visibility: hidden">\\('+e.substring(o+2,r)+"\\)</span>",n=r+2,o=e.indexOf("$$",n)}return t+=e.substring(n)},s._createCssClass=function(e,t){var n=document.createElement("style");n.type="text/css",document.getElementsByTagName("head")[0].appendChild(n),(n.sheet||{}).insertRule?n.sheet.insertRule("."+e+"{"+t+"}",0):(n.styleSheet||n.sheet).addRule(e,t),s.customCssClasses.push(e)},s._copyColorToStrokeAndFill=function(e){var t=e.css("color");e.find("g[stroke]").attr("stroke",null).attr("fill",null);var n="bw-math-jax-expression-"+s.nextUniqueId++,o="stroke: "+t+"; fill: "+t+";";s._createCssClass(n,o),e.addClass(n)},s.schedule=function(e){void 0!==window.MathJax&&window.MathJax.hasOwnProperty("Hub")&&window.MathJax.Hub.hasOwnProperty("Queue")?window.MathJax.Hub.Queue(e):s.queue.push({cb:e})},s.findMathElems=function(e){return e.find(".bwmathquill")},s.allMathElems=function(){return r(".bwmathquill")},s.processMathElems=function(e){this.process(this.findMathElems(e))},s.redrawMathElems=function(e){this.redraw(this.findMathElems(e))},s.processAll=function(){this.process(this.allMathElems())},s.redrawAll=function(){this.redraw(this.allMathElems())},s.process=function(e){this.disabled||e.each(function(){if(void 0!==window.MathJax&&window.MathJax.hasOwnProperty("Hub")&&window.MathJax.Hub.hasOwnProperty("Queue")){var e=this;window.MathJax.Hub.Queue(["Typeset",window.MathJax.Hub,e],function(){s._copyColorToStrokeAndFill(r(e)),r(e).css("visibility","")})}else s.queue.push({obj:r(this)})})},s.processqueue=function(){for(;s.queue.length>0;){var e=s.queue.shift();e.obj&&s.process(e.obj),e.cb&&s.schedule(e.cb)}},window.MathJax={showMathMenu:!1,skipStartupTypeset:!0},"ibw-platform-win32-preview"==i.getPlatform()&&(window.MathJax.SVG={scale:200}),s.loadMathJax=function(){var e=document.createElement("script");e.type="text/javascript",e.src="external/MathJax24/MathJax.js?config=TeX-AMS-MML_SVG",e.onload=s.processqueue,document.getElementsByTagName("head")[0].appendChild(e)},o.getConfig().then(function(e){e.hasOwnProperty("modules")&&-1!==e.modules.indexOf("MathJax24")?s.loadMathJax():s.disabled=!0}),s.redraw=function(e){},a.CssUpdateCallbacks&&a.CssUpdateCallbacks.push(function(){var e=s.customCssClasses;s.customCssClasses=[];for(var t=0;t<e.length;++t){var n=e[t],o=r("."+n);o.removeClass(n),s._copyColorToStrokeAndFill(o)}}),s.isOnlyMath=function(e){var t=e.trim();return t.startsWith("$$")&&t.endsWith("$$")&&-1===t.substring(2,e.length-4).indexOf("$$")},s)},238:function(e,t,n){var o,i,r;n(239),e.exports=(o=n(7),i=n(0),r={},window.BWAUDIO=r,r.loaded=!1,r.queue=[],r.elementqueue=[],r.process=function(e){!0===r.loaded?0===e.find(".mejs-container.mejs-audio").length&&e.mediaelementplayer({enableKeyboard:!1}):r.queue.push(e)},r.createElement=function(e){var t={play:function(e){if(void 0===this.element)return!1;var t;try{return e&&(t=this.element,this.element.addEventListener("playing",function n(){t.removeEventListener("playing",n),e()})),this.element.play(),!0}catch(e){return!1}},pause:function(){if(void 0===this.element)return!1;try{return this.element.pause(),!0}catch(e){return!1}},paused:function(){return void 0!==this.element&&this.element.paused},toggle:function(){void 0!==this.paused()&&!0===this.paused()?this.play():this.pause()},rewind:function(){if(void 0===this.element)return!1;try{return this.element.setCurrentTime(0),!0}catch(e){return!1}},setVolume:function(e){if(void 0===this.element)return!1;try{return this.element.setVolume(e),!0}catch(e){return!1}},on:function(e,t){if(void 0===this.element)return!1;try{return this.element.addEventListener(e,t),!0}catch(e){return!1}},onLoaded:function(e){this.element?e():this.onLoadedCB=e}};return t.obj=e,!0===r.loaded?t.element=new window.MediaElement(e,{startVolume:1}):r.elementqueue.push(t),t},r.createPlayer=function(e,t){if(t){var n=i(document.createElement("div")).addClass("audiowrapper");return i(document.createElement("div")).addClass("audio-placeholder").attr("data-src",e).appendTo(n),n}n=i(document.createElement("div")).addClass("audiowrapper").safeHtml("&nbsp;");var o=i(document.createElement("audio")).attr("controls","").append(i(document.createElement("source")).attr("src",e)).appendTo(n);return r.process(o),n},r.replaceAudioByPlaceholder=function(e){var t=this;i(e).find(":not(.audiowrapper) > audio:not(.no-audio-wrap)").each(function(){var e=i(this),n=e.find("source").attr("src");e.replaceWith(t.createPlayer(n,!0))})},r.processAudioTags=function(e){e instanceof i?r.process(e.find(":not(.mejs-mediaelement) > audio:not(.no-audio-wrap)")):r.process(i(e+" audio"))},r.replacePlaceholders=function(e){i(e).find("div.audio-placeholder").each(function(){var e=i(document.createElement("audio")).attr("controls","").append(i(document.createElement("source")).attr("src",i(this).attr("data-src"))).insertAfter(i(this));r.process(e)})},r.removeAudioElements=function(){i("audio:not(.no-audio-wrap), .mejs-container.mejs-audio").remove()},r.processqueue=function(){for(r.loaded=!0;r.queue.length>0;){var e=r.queue.shift();r.process(e)}for(;r.elementqueue.length>0;){var t=r.elementqueue.shift();t.element=new window.MediaElement(t.obj,{startVolume:1}),t.onLoadedCB&&t.onLoadedCB(t)}},r.loadMediaElement=function(){var e=document.createElement("link");e.setAttribute("rel","stylesheet"),e.setAttribute("type","text/css"),e.setAttribute("href","external/mediaelement/css/mediaelementplayer.min.css"),document.getElementsByTagName("head")[0].appendChild(e);var t=document.createElement("script");t.type="text/javascript",t.src="external/mediaelement/js/mediaelement-and-player.min.js",t.onload=r.processqueue,document.getElementsByTagName("head")[0].appendChild(t)},r.addElement=function(e,t){var n=i(document.createElement("audio")).append(i(document.createElement("source")).attr("src",e)).appendTo(t);return r.createElement(n[0])},o.getConfig().then(function(e){e.hasOwnProperty("modules")&&-1!==e.modules.indexOf("bwaudio")&&r.loadMediaElement()}),r)},239:function(e,t,n){},240:function(e,t,n){var o,i,r;e.exports=(o=n(0),i=n(241),r=n(2),{bwMakeDragAndResizable:function(e,t,n,a,s){var c=-1!==r.getPlatform().indexOf("ibooks"),l=new i.Manager(e.get(0));l.add(new i.Pan({threshold:0,pointers:0})),c||l.add(new i.Pinch({threshold:0})).recognizeWith([l.get("pan")]);var d=null;function u(t){null===d&&(d={pos:e.offset(),width:e.width(),height:e.height(),center:{x:e.offset().left,y:e.offset().top}}),t&&!d.hasOwnProperty("last_rotation")&&(d.center=t.center)}function p(t){var n=t.scale;e.offset({top:d.pos.top+t.deltaY+(d.center.y-d.pos.top)*(1-n),left:d.pos.left+t.deltaX+(d.center.x-d.pos.left)*(1-n)}),c||(e.width(d.width*n),e.height(d.height*n))}function f(t){var n=e.width(),i=e.height(),r=e.position(),a=o(window).width(),c=o(window).height();e.width(n*t),e.height(i*t),e.css("left",(r.left-a/2)*t+a/2),e.css("top",(r.top-c/2)*t+c/2),s&&s()}l.on("hammer.input",function(e){e.isFinal&&(d=null)}),l.on("panstart panmove",function(e){"panstart"===e.type?u():(p(e),a&&a())}),c||(l.on("pinchstart pinchmove",function(e){"pinchstart"===e.type?u(e):(p(e),s&&s())}),l.on("pinchend pinchcancel",function(){d&&(d=null,u())})),t.tapOrClick(function(){f(1.25)}),n.tapOrClick(function(){f(.8)})}})},241:function(e,t){e.exports=window.Hammer},242:function(e,t,n){var o=n(57);e.exports=function(e){window.addEventListener("message",function(t){var n=t.data;"set-css"===n.command&&(!function(t){e("style[id='designconfig'], link[id='designconfig']").remove();var n=document.createElement("style");n.id="designconfig",n.type="text/css",n.appendChild(document.createTextNode(t)),document.head.appendChild(n)}(n.css),o.executeCssUpdateCallbacks())})}(n(0))},243:function(e,t){e.exports=void window.addEventListener("message",function(e){"print"===e.data.command&&window.print()})},244:function(e,t,n){e.exports=function(e,t){return{createLabeledCheckbox:function(t,n,o){var i=e(document.createElement("table")).addClass("bw-checkbox").appendTo(t),r=e(document.createElement("tr")).appendTo(i),a=e(document.createElement("td")).addClass("bw-checkbox-cell").appendTo(r);return e(document.createElement("div")).addClass("bw-checkbox-checkbox bw-icon bw-icon-accept").appendTo(a),e(document.createElement("td")).addClass("bw-button-label-cell").append(e(document.createElement("div")).addClass("bw-button-label").safeHtml(n)).appendTo(r),i.bind("check",function(){e(this).attr({checked:"checked","aria-checked":"true"})}),i.bind("clear",function(){e(this).attr({checked:null,"aria-checked":"false"})}),i.makeButton({role:"checkbox"}).tapOrClick(function(){var t=e(this);"disabled"!==t.attr("disabled")&&("checked"===t.attr("checked")?(t.trigger("clear"),o&&o.call(t[0],!1)):(t.trigger("check"),o&&o.call(t[0],!0)))}),i.trigger("clear"),i},createProgressBar:function(t,n){var o={};o.parent=t,o.max=n,e(document.createElement("div")).addClass("bw-progress-bar").css("left","-100%").appendTo(e(t));var i=100/n;return e(document.createElement("div")).addClass("bw-progress-bar-marker").css({left:"-100%",width:i+"%"}).appendTo(e(t)),o.setProgress=function(n,o,i){o=o||400;var r=100*-(this.max-parseFloat(n))/this.max,a=e(this.parent+"> .bw-progress-bar"),s=e(t).width(),c=-(this.max-parseFloat(n))*s/this.max;a.css("left",a.css("left")),a.animate({left:c},o,"swing",function(){a.css("left",r+"%"),i&&i()})},o.setPosition=function(n,o){o=o||400;var i=e(this.parent+"> .bw-progress-bar-marker"),r=100*parseFloat(n)/this.max,a=e(t).width()*n/this.max;i.css("left",i.css("left")),i.animate({left:a},o,"swing",function(){i.css("left",r+"%")})},o.clear=function(){e(this.parent+" .bw-progress-bar").css("left","-100%"),e(this.parent+" .bw-progress-bar-marker").css("left","-100%")},o},createSimpleCheckbox:function(t,n,o){var i=e(document.createElement("div")).addClass("bw-simple-checkbox bw-icon bw-icon-accept").appendTo(e(t)),r={role:"checkbox"};return o&&(r.labelledby=o),i.bind("check",function(){e(this).attr({checked:"checked","aria-checked":"true"})}),i.bind("clear",function(){e(this).attr({checked:null,"aria-checked":"false"})}),i.makeButton(r).tapOrClick(function(){var t=e(this);"disabled"!==t.attr("disabled")&&("checked"===t.attr("checked")?(t.trigger("clear"),n&&n.call(t[0],!1)):(t.trigger("check"),n&&n.call(t[0],!0)))}),i.trigger("clear"),i},createNumberButtons:function(n,o,i,r,a){function s(t){if(e(".buttonslot").removeClass("selected"),o<=9)e("#BS_"+t).addClass("selected");else if(t<5){e("#BS_1").removeClass("hide_number"),e("#BS_7").addClass("hide_number");for(var n=1;n<8;++n)e("#BS_"+n).find(".number-button").safeHtml(n+1);e("#BS_"+t).addClass("selected")}else if(o-t<6){e("#BS_1").addClass("hide_number"),e("#BS_7").removeClass("hide_number");for(var i=2;i<8;++i)e("#BS_"+i).find(".number-button").safeHtml(o-8+i);e("#BS_"+(9-(o-t))).addClass("selected")}else{e("#BS_1").addClass("hide_number"),e("#BS_7").addClass("hide_number");for(var s=1;s<8;++s)e("#BS_"+s).find(".number-button").safeHtml(s+t-3);e("#BS_4").addClass("selected")}0===t?e(r).addClass("hidden"):e(r).removeClass("hidden"),t===o-1?e(a).addClass("hidden"):e(a).removeClass("hidden")}for(var c=0,l=Math.min(o,9),d=e(n),u=0;u<l;++u)e(document.createElement("div")).addClass("buttonslot").attr("id","BS_"+u).append(e(document.createElement("div")).addClass("number-button bw-button").text(u+1)).appendTo(d).find(".number-button").makeButton().tapOrClick(function(){s(c=parseInt(e(this).safeHtml())-1),i(c)});function p(){--c<0&&(c=0),s(c),i(c)}function f(){++c>=o&&(c=o-1),s(c),i(c)}return o>9&&(e(document.createElement("div")).addClass("ellipsis").appendTo(e("#BS_1")),e(document.createElement("div")).addClass("ellipsis").appendTo(e("#BS_7")),e("#BS_7").addClass("hide_number"),e("#BS_7").find(".number-button").safeHtml(o-1),e("#BS_8").find(".number-button").safeHtml(o)),e("#BS_0").addClass("selected"),e(r).addClass("hidden"),e(r).makeButton(t("previous")).tapOrClick(p),e(a).makeButton(t("next")).tapOrClick(f),{updateButtons:s,next:f,prev:p}},createSimpleRadiobutton:function(t,n,o){var i=e(document.createElement("div")).addClass("bw-simple-radiobutton bw-icon").appendTo(e(t));i.bind("check",function(){e(this).attr({checked:"checked","aria-checked":"true"})}),i.bind("clear",function(){e(this).attr({checked:null,"aria-checked":"false"})});var r={role:"radio"};return o&&(r.labelledby=o),i.makeButton(r).tapOrClick(function(){var t=e(this);"disabled"!==t.attr("disabled")&&("checked"===t.attr("checked")?(t.trigger("clear"),n&&n.call(t[0],!1)):(t.trigger("check"),n&&n.call(t[0],!0)))}),i.trigger("clear"),i},createLabeledRadiobutton:function(t,n,o){var i=e(document.createElement("table")).addClass("bw-radiobutton").appendTo(t),r=e(document.createElement("tr")).appendTo(i),a=e(document.createElement("td")).addClass("bw-radiobutton-cell").appendTo(r);return e(document.createElement("div")).addClass("bw-radiobutton-radiobutton bw-icon bw-icon-largedot").appendTo(a),e(document.createElement("td")).addClass("bw-button-label-cell").append(e(document.createElement("div")).addClass("bw-button-label").safeHtml(n)).appendTo(r),i.bind("check",function(){e(this).attr({checked:"checked","aria-checked":"true"})}),i.bind("clear",function(){e(this).attr({checked:null,"aria-checked":"false"})}),i.makeButton({role:"radio"}).tapOrClick(function(){var t=e(this);"disabled"!==t.attr("disabled")&&("checked"===t.attr("checked")?(t.trigger("clear"),o&&o.call(t[0],!1)):(t.trigger("check"),o&&o.call(t[0],!0)))}),i.trigger("clear"),i},createProgressCircle:function(t,n,o){var i={},r=30,a=40,s=40;i.id=n,i.progress=Array(o);var c=e(document.createElement("div")).addClass("bw-progress-circle bw-centering-container").attr("id",n).appendTo(e(t));e(document.createElement("div")).addClass("bw-progress-circle-text bw-centered").appendTo(c);var l=[];function d(e,t){if(-1===e)return"";var n=2*Math.PI*e/o,i=2*Math.PI*(e+1)/o,r=a+Math.sin(n)*t,c=s-Math.cos(n)*t,l=a+Math.sin(i)*t,d=s-Math.cos(i)*t;return"M X1 Y1 A R R 0 0 1 X2 Y2".replace("X1",r).replace("Y1",c).replace("X2",l).replace("Y2",d).replace("D",n).replace("R",t).replace("R",t)}function u(e){return'<path d="'+d(e,r)+'"/>'}for(var p=0;p<o;++p)l.push(u(p));return e('<svg class="bw-progress-circle-drawing" xmlns="http://www.w3.org/2000/svg" version="1.1" viewBox="0 0 80 80">'+l.join("")+'<path class="the marker"/></svg>').appendTo(c),i.setProgress=function(t,n){e("#"+this.id+" path:nth-child("+(t+1)+")").attr("class",n)},i.setTextAndPosition=function(t,n){var o=e("#"+this.id+" .bw-progress-circle-text");o.animate({opacity:0},200,"swing",function(){o.empty().append(t).animate({opacity:1},200)});var i=e("#"+this.id+" path.the.marker");i.animate({opacity:0},200,"swing",function(){i.attr("d",d(n,r)).animate({opacity:1},200)})},i}}}(n(0),n(11))},245:function(e,t,n){function o(e){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var i,r,a;e.exports=(i=n(2),r=n(0),-1!==(a=i.getPlatform()).indexOf("android")?r.fn.extend({clickOnDraggable:function(e){return this.each(function(){var t=!1;this.ClickOnDraggableCallback=e,r(this).on("touchstart",function(e){var n=e.originalEvent?e.originalEvent:e;1===n.changedTouches.length&&1===n.touches.length&&n.changedTouches[1]===n.touches[1]?(t=!0,setTimeout(function(){t&&(console.error("touch takes too long"),t=!1)},100)):t=!1}),r(this).on("touchend",function(e){if(t){var n=e.originalEvent?e.originalEvent:e;1===n.changedTouches.length&&0===n.touches.length?(t=!1,this.ClickOnDraggableCallback()):t=!1}})})}}):r.fn.extend({clickOnDraggable:function(e){return this.each(function(){r(this).click(e)})}}),-1!==a.indexOf("android")||-1!==a.indexOf("preview")||-1!==a.indexOf("phantomjs")||-1!==a.indexOf("headlesschrome")||-1!==a.indexOf("chrome")||"ibw-platform-osx-safari"===a||"ibw-platform-osx-ibooks"===a||"ibw-platform-osx-ibooks-epub"===a?r.fn.extend({tapOrClick:function(e){return this.each(function(){r(this).click(e);var t=this,n=r(this);n.is("button")||n.is("a")||n.on("keydown",function(n){var o=n.which;13!==o&&32!==o||e.bind(t)({preventDefault:function(){},stopPropagation:function(){},stopImmediatePropagation:function(){}})})})},tapOrClickOff:function(){return this.each(function(){r(this).unbind("click");var e=r(this);e.is("button")||e.is("a")||e.off("keydown")})},triggerTapOrClick:function(e){return this.each(function(){r(this).trigger("click",e)})}}):r.fn.extend({tapOrClick:function(e){return this.each(function(){var t=this,n=r(this);n.addClass("epub-block"),n.find("*").each(function(){this instanceof SVGElement||r(this).addClass("epub-block")});var o=!1;n.hammer?"ibw-platform-ipad-bookwidgets"===a||"ibw-platform-ipad-ibooks-epub"===a||"ibw-platform-ipad-ibooks"===a?n.hammer().on("tap",function(i){!1===o&&(e.bind(t)(i),o=!0,setTimeout(function(){o=!1},500)),n.blur(),i.stopImmediatePropagation()}):n.hammer().on("tap",function(o){e.bind(t)(o),n.blur(),o.stopImmediatePropagation()}):n.click(function(o){e.bind(t)(o),n.blur()}),(n.hammer||!n.is("button")&&!n.is("a"))&&n.on("keydown",function(n){var o=n.which;13!==o&&32!==o||e.bind(t)({preventDefault:function(){},stopPropagation:function(){},stopImmediatePropagation:function(){}})})})},tapOrClickOff:function(){return this.each(function(){var e=r(this);e.hammer?e.hammer().off("tap"):e.unbind("click"),(e.hammer||!e.is("button")&&!e.is("a"))&&e.off("keydown")})},triggerTapOrClick:function(e){return this.each(function(){var t=r(this);t.hammer?t.hammer().trigger("tap",e):t.trigger("click",e)})}}),r.fn.extend({clickOrHold:function(e,t,n){return n=n||3e3,this.each(function(){var o=!1,i=null;r(this).click(function(t){o||e.bind(this)(t),o=!1}),r(this).on("keydown",function(t){var n=t.which;13!==n&&32!==n||e.bind(this)({prevent:function(){},stopPropagation:function(){},stopImmediatePropagation:function(){}})}),r(this).on("mousedown touchstart",function(){var e=this;i=setTimeout(function(){i=null,o=!0,t.bind(e)()},n)}),r(this).on("mouseup touchend",function(){null!==i&&(clearTimeout(i),i=null),o&&setTimeout(function(){o=!1},400)})})}}),void r.fn.extend({makeButton:function(e){"string"==typeof(e=e||{})&&(e={label:e}),this.attr({role:e.hasOwnProperty("role")?e.role:"button"});var t=this.attr("tabindex");return"undefined"!==o(t)&&!1!==t||this.attr({tabindex:"0"}),e.hasOwnProperty("label")&&this.attr({"aria-label":e.label}),e.hasOwnProperty("labelledby")&&this.attr({"aria-labelledby":e.labelledby}),this},makeLink:function(e){return this.attr({role:"link",tabindex:"0"}),e&&this.attr({"aria-label":e}),this}}))},246:function(e,t,n){var o;e.exports=(o=n(0),{positionPointerPopup:function(e,t,n,i,r,a,s){var c=arguments.length>7&&void 0!==arguments[7]?arguments[7]:"right",l=arguments.length>8&&void 0!==arguments[8]?arguments[8]:null;l=l||t,t.css({left:"0px",top:"0px"}).addClass("almostvisible"),l.find(".triangle").remove();var d=n.centerx,u=n.centery,p=t.outerWidth(),f=t.outerHeight();t.removeClass("almostvisible");var h=25/Math.sqrt(2),g=i+n.x>p+e+25,m=a-n.x-n.width-i>p+e+25,w=r+n.y>f+e+25,b=s-n.y-n.height-r>f+e+25,v=50;function y(){u<f/2+e&&(u=f/2+e),s-u<f/2+e&&(u=s-f/2-e)}function k(){return Math.min(Math.max(-2,f/2-h-(t.outerHeight()-t.height())/2+n.centery-u),t.outerHeight()-v-2)}function C(){d<p/2+e&&(d=p/2+e),a-d<p/2+e&&(d=a-p/2-e)}function x(){return Math.min(Math.max(-2,p/2-h-(t.outerWidth()-t.width())/2+n.centerx-d),t.outerWidth()-v-2)}var S=null,T=null;if("center"!==c){var _=0;switch(c){case"right":_=0;break;case"left":_=1;break;case"bottom":_=2;break;case"top":_=3}for(var E=0;E<4;++E){var O=(E+_)%4;if(0===O&&m){y(),T="lefttriangle",S={left:-50,top:k()},d+=p/2+n.width/2+25;break}if(1===O&&g){y(),T="righttriangle",S={left:p-2*parseInt(t.css("border-right-width")),top:k()},d-=p/2+n.width/2+25;break}if(2===O&&b){C(),T="toptriangle",S={left:x(),top:-50},u+=f/2+n.height/2+25;break}if(3===O&&w){C(),T="bottomtriangle",S={left:x(),top:f-2*parseInt(t.css("border-top-width"))},u-=f/2+n.height/2+25;break}}}var I=Math.min(Math.max(0,d-p/2),a-p),P=Math.min(Math.max(0,u-f/2),s-f);if(t.css({left:I+"px",top:P+"px"}),t.removeClass("hidden"),S){var A=t.offset(),L=l.offset();S.left+=A.left-L.left,S.top+=A.top-L.top,o(document.createElement("div")).addClass("triangle "+T).appendTo(l).css(S)}}})},247:function(e,t,n){e.exports=function(e,t,o,i){var r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:n(2),a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:n(248),s=arguments.length>6&&void 0!==arguments[6]?arguments[6]:n(249),c=arguments.length>7&&void 0!==arguments[7]?arguments[7]:n(250);function l(t){this._storage=t,this.setCredentials=function(t){var n=this;return e.Deferred(function(e){n._storage.setItemsAsync([{key:"BwCredentials",value:JSON.stringify(t),attribs:""}],function(){e.resolve()},function(){e.reject()})})},this.getCredentials=function(){var t=this;return e.Deferred(function(e){t._storage.getItemsAsync(["BwCredentials"],function(t){try{var n=JSON.parse(t.BwCredentials.value);e.resolve(n)}catch(t){e.reject()}},function(){e.reject()})})}}var d=o.isLTI()||t.getParameters().sso;return d&&console.log("Using session storage for credentials"),"ibw-platform-ipad-bookwidgets"===r.getPlatform()?new l(new s):r.usesCredentialProxy()?new l(new c("_secureStorage",!0,t.getQueryParams(window.location.search)["bwds-secure-proxy-token"],d)):new function(t){this.setCredentials=function(n){return e.Deferred(function(e){try{t.SetItem("BwCredentials",JSON.stringify(n)),e.resolve()}catch(t){e.reject()}})},this.getCredentials=function(){return e.Deferred(function(e){try{var n=JSON.parse(t.GetItem("BwCredentials"));e.resolve(n)}catch(t){e.reject()}})}}(d?i:a)}.bind(null,n(0),n(8),n(55),n(252))},248:function(e,t){e.exports={GetItem:function(e){return localStorage.getItem(e)},RemoveItem:function(e){localStorage.removeItem(e)},SetItem:function(e,t){localStorage.setItem(e,t)},Clear:function(){localStorage.clear()}}},249:function(e,t,n){var o=n(103);e.exports=function(e,t){var i=n(59).createLogger("NativeSQLAsyncKeyStore"),r=new e;r.startListening();return function(e){e=e||function(e){var t=document.createElement("IFRAME");t.setAttribute("src",e),t.setAttribute("height","1px"),t.setAttribute("width","1px"),document.documentElement.appendChild(t),t.parentNode.removeChild(t),t=null};var t={};function n(e){var t=String.fromCharCode(29);return(e=e.map(function(e){return e.replace(new RegExp(",","g"),t)})).join()}return t.resultForCallback=function(e,t){r.processCallback(e,t)},t.runningInIframe=function(){try{return window.self!==window.parent}catch(e){return!0}},t.callObjC=function(n,i,a,s){var c=o.url(n,i),l=r.registerCallbacks(a,s),d="'"+l.ok+"'",u="'"+l.error+"'",p="BWKSNativeSQL.resultForCallback";t.runningInIframe()&&(p="function BWKSNativeSQL_callback_wrapper(callbackID, arg) { window.postMessage({ 'command': callbackID, 'arg': arg, 'to': '_widget' }, '*'); }; BWKSNativeSQL_callback_wrapper"),e(c+"&okCallbackId="+d+"&errorCallbackId="+u+"&callbackFunc="+p)},t.getItemsAsync=function(e,o,r){if(0==e.length)return i.error("NativeSQL Error: getItemsAsync without names"),void r({message:"NativeSQL Error: getItemsAsync without names"});t.callObjC("getItemsAsync",{names:n(e)},o,r)},t.getDirAttribs=function(e,n,o){t.callObjC("getDirAttribsAsync",{dirname:e},n,o)},t.setItemsAsync=function(e,n,o){if(0==e.length)return i.error("NativeSQL Error: setItemsAsync without names"),void o({message:"setItemsAsync without names"});if(e.length>1)return i.error("NativeSQL Error: setItemsAsync can only handle 1 item"),void o({message:"setItemsAsync can only handle 1 item"});var r=e[0];t.callObjC("setItemAsync",{keyname:r.key,value:r.value,attribs:r.attribs},n,o)},t.removeItemsAsync=function(e,o,r){if(0==e.length)return i.error("NativeSQL Error: removeItemsAsync without names"),void r({message:"NativeSQL Error: removeItemsAsync without names"});t.callObjC("removeItemsAsync",{names:n(e)},o,r)},t}}(n(58))},250:function(e,t,n){var o,i;e.exports=(o=n(251),n(8),(i=function(e,t,n,i){this.sender=new o(e,"*"),this.useSessionStorage=i,this.token=n}).prototype.postMessage=function(e,t,n){this.token&&(e.token=this.token),this.useSessionStorage&&(e.useSessionStorage=!0),this.sender.send(e,function(e,o){return e?n(e):t(o)})},i.prototype.getItemsAsync=function(e,t,n){this.postMessage({command:"getItems",names:e},t,n)},i.prototype.setItemsAsync=function(e,t,n){this.postMessage({command:"setItems",items:e},t,n)},i.prototype.removeItemsAsync=function(e,t,n){this.postMessage({command:"removeItems",names:e},t,n)},i.prototype.clearAllAsync=function(e,t){this.postMessage({command:"clear"},e,t)},i.prototype.getDirAttribs=function(e,t,n){this.postMessage({command:"getDirAttribs",name:e},t,n)},i)},251:function(e,t,n){var o,i;e.exports=(o=n(58),(i=function(e,t){this.name=e,this.origin=t,this.callbackBridge=new o,this.callbackBridge.startListening()}).prototype.send=function(e,t,n){e.to=this.name,e.cb=this.callbackBridge.registerCallback(t,n),parent.postMessage(e,this.origin)},i)},252:function(e,t){e.exports={GetItem:function(e){return sessionStorage.getItem(e)},RemoveItem:function(e){sessionStorage.removeItem(e)},SetItem:function(e,t){sessionStorage.setItem(e,t)},Clear:function(){sessionStorage.clear()}}},253:function(e,t,n){e.exports=function(e,t,n,o,i,r,a){var s={},c=e.getConfigSync();function l(){var e=r.getPlatform();return!!("ibw-platform-ipad-ibooks"===e||"ibw-platform-ipad-ibooks-epub"===e||"ibw-platform-osx-ibooks"===e||"ibw-platform-osx-ibooks-epub"===e||"ibw-platform-android-chrome"===e||r.isPreview()||"ibw-platform-ipad-bookwidgets"!==e&&!1===r.isTopLevelPlay())}function d(e){for(var t=0;t<e.bw_links.length;++t){var n=e.bw_links[t];if("bw-student"===n.name)return n}return null}function u(){return c.hasOwnProperty("student_account_school")&&c.student_account_school.hasOwnProperty("code")&&null!==c.student_account_school.code&&""!==c.student_account_school.code&&"null"!==c.student_account_school.code}return s.createDialog=function(e,n){var o=t(document.createElement("div")).addClass("bw-login-dialog-wrapper"),r=t(document.createElement("div")).css({position:"absolute",width:"100%",height:"100%",left:"0px",top:"0px"}).appendTo(o),a=t(document.createElement("div")).attr("id","bw-login-dialog").addClass("bw-row-container").appendTo(o);return n&&(o.addClass("bw-centering-container"),a.addClass("bw-centered")),o.appendTo("body"),e&&r.click(function(){o.remove(),e.reject()}),{close:o.remove.bind(o),show:function(e,n){var o;a.empty(),n&&t(document.createElement("div")).addClass("login-dialog-title bw-row-fixed").safeHtml(n).appendTo(a),e.appendTo(a),(o=a).find(".weblink").each(function(){i(t(this).parent()[0],t(this).attr("href"),!0,t(this).attr("message")),t(this).attr("href","")}),o.find(".external-link").each(function(){i(this,t(this).attr("href"),!1,t(this).attr("message")),t(this).attr("href","")})}}},s.queryLoginMethod=function(e){var n=this;return t.Deferred(function(i){var r=n.createDialog(i,!0),a=t(document.createElement("div")).addClass("login-type-selection login-dialog-body");var s,c=d(e),p=null!==c;function f(){removeEventListener("message",h),r.close()}function h(e){var t=e.data;t.hasOwnProperty("msg")&&"linkclicked"===t.msg&&(f(),i.resolve("oauth"))}e.oauth_links.length>0&&function(n,i){n=e.oauth_links;for(var r=0;r<n.length;++r){var a=n[r],s=l()&&a.toplevel,c=s?" weblink login-type-button":" login-type-button",d=s?"_blank":"_top",u=s?"":"setTimeout(function() { window.postMessage({ msg:'linkclicked'}, '*');}, 1000);";t(document.createElement("div")).addClass("web-link-wrapper"+c).append(t(document.createElement("a")).attr({message:"linkclicked",href:a.url,target:d,onclick:u}).safeHtml(o("Sign in using")+" "+a.name)).appendTo(i)}}(e.oauth_links,a),p&&(u()||(s=a,t(document.createElement("div")).addClass("login-type-button").safeHtml(o("Sign in using email and password")).tapOrClick(function(){i.resolve("bw"),f()}).appendTo(s)),function(e,n){t(document.createElement("div")).addClass("login-type-button").safeHtml(o("Sign in using school account")).tapOrClick(function(){i.resolve("school"),f()}).appendTo(n)}(0,a)),r.show(a,o("Sign in")),window.postMessage({msg:"requestlogin"},"*"),addEventListener("message",h)}).promise()},s.queryBWCredentials=function(e){var n=this;return t.Deferred(function(i){var r=n.createDialog(i,!0),a=d(e),s=t(document.createElement("div")).addClass("login-form login-dialog-body");function c(){removeEventListener("message",u),r.close()}function u(e){var t=e.data;t.hasOwnProperty("msg")&&"linkclicked"===t.msg&&(c(),i.resolve({action:"signup"}))}!function(e,n){var r=t(document.createElement("input")).addClass("login-dialog-field").attr({id:"bw-email",placeholder:o("Email"),tabindex:"1"}).appendTo(n),a=t(document.createElement("input")).addClass("login-dialog-field").attr({id:"bw-password",type:"password",placeholder:o("Password"),tabindex:"2"}).appendTo(n);t(document.createElement("button")).addClass("login-dialog-button").attr("tabindex","3").safeHtml(o("Sign in")).tapOrClick(function(){i.resolve({action:"login",school:"",username:r.val(),password:a.val()}),c()}).appendTo(n);var s=l(),d=s?" external-link":"",u=s?"_blank":"_top",p=s?"":"setTimeout(function() { window.postMessage({ msg:'linkclicked'}, '*');}, 1000);";e.hasOwnProperty("resetPasswordURL")&&t(document.createElement("a")).attr({href:e.resetPasswordURL,target:u,onclick:p}).safeHtml(o("Forgot password?")).addClass("bw-reset-password"+d).appendTo(n),e.hasOwnProperty("registerURL")&&(t(document.createElement("hr")).appendTo(n),t(document.createElement("p")).css("position","relative").appendSafe("Don't have an account?").append(t(document.createElement("br"))).append(t(document.createElement("a")).attr({message:"linkclicked",href:e.registerURL,target:u,onclick:p}).addClass("bw-signup"+d).safeHtml(o("Sign up here"))).appendTo(n))}(a,s),r.show(s,o("Sign in")),window.postMessage({msg:"requestlogin"},"*"),addEventListener("message",u)}).promise()},s.querySchoolCredentials=function(e){var n=this;return t.Deferred(function(e){var i,r=n.createDialog(e,!0),a=t(document.createElement("div")).addClass("login-form login-dialog-body");u()||(i=t(document.createElement("input")).attr({id:"school-school",placeholder:o("School code"),tabindex:"1"}).addClass("login-dialog-field").appendTo(a));var s=t(document.createElement("input")).attr({id:"school-username",placeholder:o("Username"),tabindex:"2"}).addClass("login-dialog-field").appendTo(a),l=t(document.createElement("input")).attr({id:"school-password",type:"password",placeholder:o("Password"),tabindex:"3"}).addClass("login-dialog-field").appendTo(a);t(document.createElement("button")).addClass("login-dialog-button").attr("tabindex","4").safeHtml(o("Sign in")).tapOrClick(function(){var t=u()?c.student_account_school.code:i.val();e.resolve({action:"login",school:t,username:s.val(),password:l.val()}),r.close()}).appendTo(a),r.show(a,u()?c.student_account_school.name:o("Sign in")),window.postMessage({msg:"requestlogin"},"*")}).promise()},s.queryLogout=function(e,n,i,r){var a=this;return t.Deferred(function(s){var c=a.createDialog(s),l=t(document.createElement("div")).attr("id","offline-dialog").addClass("login-dialog-body");t(document.createElement("p")).safeHtml(n).appendTo(l),t(document.createElement("div")).attr("id","login-current-user").safeHtml(i||"").appendTo(l),r||t(document.createElement("div")).addClass("login-dialog-button").safeHtml(o("Sign out")).tapOrClick(function(){c.close(),s.resolve()}).appendTo(l),c.show(l,e)}).promise()},s.showMessage=function(e,i){return t.Deferred(function(t){n.showAlert(e,i,o("OK"),function(){t.resolve()})})},s.createPollingUI=function(e){var n=this.createDialog(null,!0),i=t(document.createElement("div")).addClass("login-pollingdialog");return t(document.createElement("p")).safeHtml(o("Waiting for account sign in to complete...")).appendTo(i),t(document.createElement("div")).addClass("login-dialog-button").safeHtml(o("Cancel")).tapOrClick(e).appendTo(i),n.show(i,o("Waiting")),n},s}(n(7),n(0),n(21),n(11),n(104),n(2),n(35))},254:function(e,t,n){e.exports=function(e){return function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:100,o=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=e(document.createElement("div")).addClass("bw-throbber-wrapper bw-centering-container").appendTo(t),r=e(document.createElement("canvas")).addClass("bw-throbber bw-centered").attr({width:n,height:n}).appendTo(i),a=r[0].getContext("2d");a.translate(n/2,n/2);for(var s=30*n/100,c=0;c<s;++c){a.rotate(2*-Math.PI/s);var l=o?0:255;a.strokeStyle="rgba("+l+","+l+","+l+","+(1/s).toFixed(2)+")",a.lineWidth=3,a.moveTo(n/5,0),a.lineTo(2*n/5,0),a.stroke()}var d=null,u=!1;return window.requestAnimationFrame(function e(t){if(d||(d=t),!u){var n="rotate("+360*Math.floor(t/1e3*s)/s+"deg)";r.css({transform:n,"-webkit-transform":n,"-moz-transform":n,"-ms-transform":n}),window.requestAnimationFrame(e)}}),{close:function(){i.remove(),u=!0}}}}(n(0))},255:function(e,t,n){var o;e.exports=(o=n(7).getConfigSync(),{getAJAXHeaders:function(){return null!=o.widget_language&&o.widget_language.length>0?{"Accept-Language":o.widget_language}:{}}})},256:function(e,t,n){var o,i,r,a,s,c,l,d,u;e.exports=(o=n(7),i=n(102).o,r=n(105),a=n(0),s=n(11),c=n(35),l=n(2),d=n(21),u=o.getConfigSync(),{init:function(){function e(){return i.getState()===i.ANONYMOUS?i.requestSignin():i.requestSignout()}function t(){if(l.isPreview()){var t=i.hasSchool()?s("Students need school accounts associated with %(school)s (%(schoolCode)s) in order to sign in.").replace("%(school)s",u.student_account_school.name).replace("%(schoolCode)s",u.student_account_school.code)+"<br><br>":s("Any BookWidgets student account can be used to sign in.")+"<br><br>";d.showAlert(s("Your widget will require students to sign in.")+"<br><br>"+t+s("In widget preview mode sign in is not required / not supported."),s("Sign in not available"))}else r.pushAsyncFunc(e)}function n(e){var t="anonymous",n=s("Not signed in");switch(e){case i.OFFLINE:t="offline",n=s("You're offline");break;case i.ONLINE:t="online";var o=i.getUserName();-1!=o.indexOf("@")&&(o=o.substring(0,o.indexOf("@"))),n=o}var r=a("#loginbutton");if((r.safeHtml()!==n||r.attr("state")!==t)&&(r.safeHtml(n).attr({state:t}),e==i.OFFLINE||e==i.ONLINE)){var l=a(document.createElement("div")).addClass("login-change-wrapper").appendTo("#top-container"),d=r.clone();d.attr("id","login-change-alert").appendTo(l).fadeIn(400,"swing",function(){setTimeout(function(){d.fadeOut(400,"swing",function(){l.remove()})},1e3)}),r.effect&&r.effect("pulsate",{times:4},500)}c.centerTitle()}var o;o=a(document.createElement("div")).addClass("loginbutton bw-tooltext").attr("id","loginbutton"),c.prependToTitleToolbar(o),n(i.ANONYMOUS),o.tapOrClick(t),i.initialized().then(function(){n(i.getState()),i.registerStateChangeCallback(n)},function(){n(i.ANONYMOUS),a("#loginbutton").hide()})}})},257:function(e,t,n){var o=n(54).extend,i=n(103);e.exports=function(e,t,r){var a=n(59).createLogger("ProgressLogger"),s=new e;s.startListening();return function(e){var n=void 0!==e||"ibw-platform-ipad-bookwidgets"===t.getPlatform();e=e||function(e){var t=document.createElement("IFRAME");t.setAttribute("src",e),t.setAttribute("height","1px"),t.setAttribute("width","1px"),document.documentElement.appendChild(t),t.parentNode.removeChild(t),t=null};var r={};function c(e,t){r.callObjC("progress",o({cmd:e},t),function(){a.error("ProgressLogger: OK for:"+e)},function(){a.error("ProgressLogger: ERROR for:",e)})}r.resultForCallback=function(e,t){s.processCallback(e,t)},r.runningInIframe=function(){try{return window.self!==window.parent}catch(e){return!0}},r.callObjC=function(t,n,o,a){var c=i.url(t,n),l=s.registerCallbacks(o,a),d="'"+l.ok+"'",u="'"+l.error+"'",p="ProgressLogger.resultForCallback";r.runningInIframe()&&(p="function ProgressLogger_callback_wrapper(callbackID, arg) { window.postMessage({ 'command': callbackID, 'arg': arg, 'to': '_widget' }, '*'); }; ProgressLogger_callback_wrapper"),e(c+"&okCallbackId="+d+"&errorCallbackId="+u+"&callbackFunc="+p)},r.restart=function(){n&&c("restart")},r.registerScore=function(e,t,o,i,r){return n?(c("registerScore",{identifier:e,title:t,score:i,maxScore:o,primary:!0===r}),{lastval:i,update:function(n){return n!==this.lastval&&(c("updateScore",{identifier:e,title:t,score:n,maxScore:o,primary:!0===r}),this.lastval=n,!0)}}):{update:function(){return!1}}},r.registerBinary=function(e,t,n,o,i){return{update:function(){return!1}}},r.registerQuantity=function(e,t,o,i){return n?(c("registerQuantity",{identifier:e,title:t,quantity:o,primary:!0===i}),{lastval:o,update:function(n){return n!==this.lastval&&(c("updateQuantity",{identifier:e,title:t,quantity:n,primary:!0===i}),this.lastval=n,!0)}}):{update:function(){return!1}}};var l=0;return r.setProgress=function(e,t){if(n){var o=Math.max(0,Math.min(1,e/t));o!==l&&(c("setProgress",{progress:o}),l=o)}},r.registerSet=function(e,t,o,i){if(!n)return{registerAccess:function(){return!1}};var r=this;return{elements:[],accesscount:0,accessedcount:0,accessedLogger:this.registerQuantity(e+"accessed",t,0),accessesLogger:this.registerQuantity(e+"accesses",o,0),registerAccess:function(e){return this.accessesLogger.update(++this.accesscount),this.elements.hasOwnProperty(e)||(this.elements[e]=!0,this.accessedLogger.update(++this.accessedcount),r.setProgress(this.accessedcount,i)),!0}}},window.ProgressLogger=r,r}}(n(58),n(2))},35:function(module,exports,__webpack_require__){var _require=__webpack_require__(44),valueOrCacheValue=_require.valueOrCacheValue;module.exports=function(platform,qs,cssUpdater,printer,dialog,tr,$,uiComponents,uriEncodeImage,bwTool,adaptToPageProtocol,bwTouchHelpers){function getNakedURL(e){if(-1===e.indexOf("?"))return e;var t=/^([^\?]*)\?/.exec(e);if(t&&2===t.length)return t[1];throw Error("Shoudln't happen")}function setQueryParameters(e,t){if(t==={})return e;var n=getNakedURL(e),o=[];return $.each(t,function(e,t){o.push(e+"="+t)}),n+"?"+o.join("&")}function ShowBacklinkIfRequired(){var e=qs.getUrlParams(window.location.href);if(e.hasOwnProperty("backlink")){var t=valueOrCacheValue(e.backlink);(e.hasOwnProperty("backbutton")?$(document.createElement("div")).addClass("widget-backlink widget-backlink-text").safeHtml("&#9664; ").text(valueOrCacheValue(e.backbutton)).appendTo($("body")):$(document.createElement("div")).addClass("widget-backlink widget-backlink-icon").appendTo($("body"))).click(function(){var e=platform.getPlatform();if("ibw-platform-osx-preview"===e||"ibw-platform-win32-preview"===e)console.log("Moving back by using history.back()"),window.history.back();else{var n=window.location.origin;t.startsWith(n)&&(t=t.substr(n.length)),console.log("Moving back by setting window.location to: "+t),window.location=t}})}}var block_recurse_guard=!1;function centerWidgetTitle(e){if(!block_recurse_guard){var t=$("#top-container"),n=t.height(),o=t.width(),i=$(".closebutton-container"),r=$("#top-container .bw-toolbar");i.css("min-width",""),r.css("min-width","");var a=i.width(),s=r.width();if(r.css("min-width",a),i.css("min-width",s),$(".title-container").css("max-width",o-2*Math.max(a,s)),!0!==e&&$("#top-container").height()!==n){block_recurse_guard=!0;try{window.onresize&&window.onresize()}catch(e){console.error("Error when calling onResize during centerWidgetTitle"),console.error(e)}block_recurse_guard=!1}}}function hidePopupMenu(){$("#top-container").removeClass("bw-show-popup-menu"),$("#title-toolbar").appendTo($("#top-container .bw-toolbar")),$(".bw-menu-overlay").remove()}function createPopupToolbarIfRequired(){if(!($("#menubutton").length>0)){var e=$("#top-container .bw-toolbar");if(e.children(":not(.outside-popup)").length>1){e.removeClass("bw-toolbar");var t=$(document.createElement("div")).addClass("bw-toolbar").appendTo($(".titlebar-layout"));e.find(".outside-popup").each(function(){$(this).appendTo(t)}),e.appendTo(t).addClass("bw-button-group"),$(document.createElement("div")).attr("id","menubutton").addClass("bw-toolbutton").append($(document.createElement("div")).addClass("bw-icon bw-icon-menu")).makeButton(tr("Menu")).tapOrClick(function(){$("#top-container").hasClass("bw-show-popup-menu")?hidePopupMenu():setTimeout(function(){$("#top-container").addClass("bw-show-popup-menu");var e=$(document.createElement("div")).addClass("bw-menu-overlay").appendTo("#container");setTimeout(function(){e.on("click touchend",function(){setTimeout(hidePopupMenu,500)})},350),$("#title-toolbar").appendTo(e)},100)}).appendTo(t)}}}function createTitleLayout(e,t,n){var o=$(e),i=$(document.createElement("div")).attr("id","container").prependTo(o).addClass("top-bottom-layout"),r=$(document.createElement("div")).attr("id","top-container").appendTo(i).addClass("top-container"),a=$(document.createElement("div")).appendTo(r).addClass("titlebar-layout");return $(document.createElement("div")).addClass("closebutton-container").appendTo(a),$(document.createElement("div")).addClass("title-container").append($(document.createElement("span")).attr("id","title")).appendTo(a),n?$(n).addClass("bw-toolbar").appendTo(a):$(document.createElement("div")).attr("id","title-toolbar").addClass("bw-toolbar").appendTo(a),createPopupToolbarIfRequired(),$(t).appendTo(i).addClass("bottom-container"),centerWidgetTitle(),i}function prependToTitleToolbar(e){var t=$("#title-toolbar");e.prependTo(t),createPopupToolbarIfRequired(),centerWidgetTitle()}function openDebugWindow(){var debugwindow=$(document.createElement("div")).addClass("bw-debug-window bw-row-container").appendTo("body"),debugoutput=$(document.createElement("div")).addClass("bw-debug-output bw-row-resizing").appendTo(debugwindow);function appendOutput(e){e.appendTo(debugoutput),debugoutput[0].scrollTop=debugoutput[0].scrollHeight-debugoutput[0].getBoundingClientRect().height}function argsToString(e){for(var t=[],n=0;n<e.length;++n)t.push(JSON.stringify(e[n]));return t.join(" ")}$(document.createElement("div")).addClass("bw-debug-close").text("X").tapOrClick(function(){debugwindow.remove(),localStorage.removeItem("bw-debug-enabled")}).appendTo(debugwindow),console.log=function(){appendOutput($(document.createElement("p")).safeHtml(argsToString(arguments)))},console.error=function(e,t){appendOutput($(document.createElement("p")).css("color","red").safeHtml(argsToString(arguments)))},window.onerror=function(e,t,n){return appendOutput($(document.createElement("p")).attr("style","color: red").safeHtml(e+" ("+t+":"+n+")")),!0},console.log(platform.getPlatform(),navigator.platform,navigator.userAgent,window.innerWidth,window.innerHeight);var debuginput=$(document.createElement("input")).addClass("bw-debug-input bw-row-fixed").appendTo(debugwindow),commandlist=[],index=0;function exec(str){var goodstr=str.replace(/[\u2018\u2019]/g,"'").replace(/[\u201C\u201D]/g,'"');console.log(eval(goodstr)),commandlist.push(goodstr),index=commandlist.length}debuginput.keypress(function(e){13===(e.keyCode?e.keyCode:e.which)&&(exec(debuginput.val()),debuginput.val(""))}),debuginput.keydown(function(e){var t=e.keyCode?e.keyCode:e.which;38===t?index>0&&(--index,debuginput.val(commandlist[index])):40===t&&index<commandlist.length&&(++index===commandlist.length?debuginput.val(""):debuginput.val(commandlist[index]))});try{debugwindow.draggable()}catch(e){console.error("No drag support")}}function showDebugDialog(){if(!($(".bw-debug-window").length>0)){var e=$(document.createElement("div")).addClass("bw-debug-wrapper").appendTo("body"),t=$(document.createElement("div")).addClass("bw-debug-dialog").appendTo(e);$(document.createElement("p")).text("Enter your support key:").appendTo(t);var n=$(document.createElement("input")).attr("placeholder","key").appendTo(t);$(document.createElement("br")).appendTo(t),$(document.createElement("button")).attr("type","button").text("Cancel").tapOrClick(function(){e.remove()}).appendTo(t),$(document.createElement("button")).attr("type","button").text("OK").tapOrClick(function(){"bw-magic"===n.val()&&(openDebugWindow(),e.remove(),localStorage.setItem("bw-debug-enabled","true"))}).appendTo(t)}}function initializeDebugSupport(e){var t=0;e.clickOrHold(function(){t=0},function(){3==++t&&(showDebugDialog(),t=0)},2e3);try{"true"===localStorage.getItem("bw-debug-enabled")&&openDebugWindow()}catch(e){}}function enableOsxIbooksHack(){if("ibw-platform-osx-ibooks"===platform.getPlatform()){var e=["html.ibw-platform-osx-ibooks, .ibw-platform-osx-ibooks .bw-popup-zoomable-image {","width: "+window.innerWidth+"px;","height: "+window.innerHeight+"px;","}"],t=document.createElement("style");t.id="osx_ibooks_workaround",t.type="text/css",t.appendChild(document.createTextNode(e.join("\n"))),document.head.appendChild(t)}}function makeWidget(e){e=e||{},enableOsxIbooksHack();var t=$("body");t.addClass("bw"),e.hasOwnProperty("no-user-select")&&!0===e["no-user-select"]&&t.addClass("no-user-select");var n,o=e.layout||"";if("title_layout"===o?(n=createTitleLayout("body","#bottom-container")).find(".top-container").addClass("title-only"):"title_overlay_layout"===o?((n=createTitleLayout("body","#bottom-container")).addClass("title-overlay"),n.find(".top-container").addClass("title-only")):n="title_toolbar_layout"===o?createTitleLayout("body","#bottom-container","#title-toolbar"):$("#container"),e.hasOwnProperty("title")&&""!==e.title){var i=n.find("#title");i.safeHtml(e.title),initializeDebugSupport(i)}else{var r=n.find(".top-container");r.addClass("title-empty"),initializeDebugSupport(r)}"ibw-platform-ipad-ibooks-epub"===platform.getPlatform()&&(e.hasOwnProperty("epubBlockTouchEndCheck")||(e.epubBlockTouchEndCheck=function(e){return e.srcElement instanceof SVGElement||$(e.srcElement).hasClass("epub-block")}),document.addEventListener("touchend",function(t){var n=$(window).width();(t.layerX<50||n-t.layerX<50||e.epubBlockTouchEndCheck(t))&&t.preventDefault()},!1),e.hasOwnProperty("epubBlockTouchStartCheck")&&document.addEventListener("touchstart",function(t){e.epubBlockTouchStartCheck(t)&&t.preventDefault()},!1)),ShowBacklinkIfRequired()}function getRoot(){return platform.isWebPreview()?window.location.pathname.substring(0,window.location.pathname.lastIndexOf("/",window.location.pathname.lastIndexOf("/")-1)):""}return $(function(){var e=platform.getPlatform(),t=$("html");t.hasClass("ibw-platform-custom")||t.addClass(e)}),window.custom_alert=dialog.showAlert,window.criticalAlert=dialog.showCriticalAlert,window.bw_confirmation_dialog=dialog.showConfirmationDialog,window.tr=tr,window.getUrlParams=qs.getUrlParams,window.getNakedURL=getNakedURL,window.setQueryParameters=setQueryParameters,window.createLabeledCheckbox=uiComponents.createLabeledCheckbox,window.createProgressBar=uiComponents.createProgressBar,window.createSimpleCheckbox=uiComponents.createSimpleCheckbox,window.createNumberButtons=uiComponents.createNumberButtons,window.createSimpleRadiobutton=uiComponents.createSimpleRadiobutton,window.createLabeledRadiobutton=uiComponents.createLabeledRadiobutton,window.createProgressCircle=uiComponents.createProgressCircle,window.URIEncodeImage=uriEncodeImage,window.BWAdaptToPageProtocol=adaptToPageProtocol,window.updateConfigCSS=bwTool.updateConfigCSS,{makeWidget:makeWidget,getNakedURL:getNakedURL,setQueryParameters:setQueryParameters,prependToTitleToolbar:prependToTitleToolbar,centerTitle:centerWidgetTitle,ShowBacklinkIfRequired:ShowBacklinkIfRequired,getRoot:getRoot}}(__webpack_require__(2),__webpack_require__(8),__webpack_require__(242),__webpack_require__(243),__webpack_require__(21),__webpack_require__(11),__webpack_require__(0),__webpack_require__(244),__webpack_require__(101),__webpack_require__(57),__webpack_require__(56),__webpack_require__(245))},44:function(e,t,n){"use strict";n.r(t),n.d(t,"replaceParamsBySessionLink",function(){return a}),n.d(t,"valueOrCacheValue",function(){return s});var o=n(106),i=n.n(o),r=["backbutton","backlink","q"];function a(e){if(""===e)return e;if("undefined"==typeof sessionStorage)return e;var t=e.substring(1).split("&"),n="cache_"+(new Date).getTime()+"_";return"?"+i()(t,function(e){for(var t=0;t<r.length;++t)if(e.startsWith(r[t]+"=")&&!e.startsWith(r[t]+"=cache_")){var o=n+t;return sessionStorage.setItem(o,decodeURIComponent(e.substring(r[t].length+1))),r[t]+"="+o}return e}).join("&")}function s(e){return null==e?e:e.startsWith("cache_")?sessionStorage.getItem(e):e}},55:function(e,t,n){var o,i,r;e.exports=(o=n(8),i=o.getParameters(),r=!!i.lti_authenticated,{isLTI:function(){return!!i.lti||!!i.lti_version},isEmbeddedLTI:function(){return!!i.lti_version},isEmbeddedLTIAuthenticated:function(){return r},setEmbeddedLTIAuthenticated:function(){r=!0,o.updateWindowQueryParameter("lti_authenticated","1")}})},56:function(e,t){e.exports=function(e){var t="file:";window&&window.location&&window.location.protocol&&(t=window.location.protocol);var n="";return 0===e.indexOf("http://")?n="http://":0===e.indexOf("https://")?n="https://":0===e.indexOf("//")&&(n="//"),""!==n?"file:"===t?"//"===n?"http:"+e:e:"http:"===t?"//"===n?"http:"+e:e:"https:"===t&&"http://"===n?e.replace("http://","https://"):"//"===n?"https:"+e:e:e}},57:function(e,t){e.exports=function(){var e=[];function t(){for(var t=0;t<e.length;++t)e[t]()}return{executeCssUpdateCallbacks:t,CssUpdateCallbacks:e,updateConfigCSS:function(e){for(var n=document.getElementsByTagName("link"),o=0,i=n.length;o<i;o++){var r=n[o],a=r.rel;if("string"!=typeof a||0===a.length||"stylesheet"===a){var s=r.getAttribute("href");0===s.indexOf("config")&&-1!==s.indexOf(".css")&&(r.setAttribute("href","config"+e+".css"),setTimeout(t,100))}}},addAllDesignInfo:function(){void 0!==window.addAllDesignInfo&&window.addAllDesignInfo()},addCSSUpdateCallback:function(t){e.push(t)}}}()},58:function(e,t,n){function o(e){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var i,r,a;e.exports=(i=n(59).createLogger("CallbackBridge"),r=1,(a=function(){this.id=r++,this.listening=!1,this.nextCallbackID=1,this.callbacks={},this.handleMessage=this._handleMessage.bind(this)}).prototype.getMessagePrefix=function(){return"bw-CBBridge-"+this.id+"-"},a.prototype.startListening=function(){window.addEventListener("message",this.handleMessage)},a.prototype.stopListening=function(){window.removeEventListener("message",this.handleMessage)},a.prototype._handleMessage=function(e){var t=this.getMessagePrefix();"object"===o(e.data)&&"string"==typeof e.data.command&&e.data.command.substr(0,t.length)===t&&(e.data.hasOwnProperty("err")?this.processCallback(e.data.command,e.data.err,e.data.data):this.processCallback(e.data.command,e.data.arg))},a.prototype.registerCallbacks=function(e,t){var n=""+this.nextCallbackID++;return this.callbacks[n]={ok:e,error:t},{ok:this.getMessagePrefix()+n+"-ok",error:this.getMessagePrefix()+n+"-error"}},a.prototype.registerCallback=function(e,t){var n=""+this.nextCallbackID++;return this.callbacks[n]={cb:e,singleshot:!t},this.getMessagePrefix()+n+"-cb"},a.prototype.processCallback=function(e,t,n){try{var o=e.match(/bw-CBBridge-.*-(.*)-(ok|error|cb)$/);if(o){var r,a=o[1],s=this.callbacks[a];return s?"cb"===o[2]?((r=s.cb)(t,n),void(s.singleshot&&delete this.callbacks[a])):(r="ok"===o[2]?s.ok:s.error,delete this.callbacks[a],void r(t)):void i.error("Cannot find callback with ID "+a+" Bridge "+this.id+this.callbacks)}i.error("Malformed callback: "+e)}catch(e){i.error(e)}},a)},59:function(e,t){e.exports=function(){var e={0:"debug",1:"info",2:"error"};function t(t,n,o){return n>=o?function(){!function(t,n,o){var i=Array.prototype.slice.call(o);i.unshift(t+" ("+e[n]+"):"),console.log.apply(console,i)}(t,n,arguments)}:function(){}}return{DEBUG:0,INFO:1,ERROR:2,createLogger:function(e,n){return void 0===n&&(n=1),{debug:t(e,0,n),info:t(e,1,n),error:t(e,2,n)}}}}()},60:function(e,t,n){e.exports=function(e){return{getImageSize:function(e,t){var n=new Image;n.onload=function(){var e=this.width,n=this.height;t(e,n)},n.onerror=function(){t()},n.src=e},processRichTextImages:function(t){t.find("img").attr({height:"",draggable:"false"}).css("max-width","100%").each(function(){var t=e(this),n=t.css("float");"left"===n?t.css({"margin-right":"10px","margin-bottom":"10px"}):"right"===n&&t.css({"margin-left":"10px","margin-bottom":"10px"})})},calculateScaleAndOffset:function(e,t,n,o,i){var r,a,s,c,l,d;return"Cover entire area, keep aspect ratio"===e?((l=t/o)<(d=n/i)?(r=d,a=d):(r=l,a=l),s=(t-o*r)/2,c=(n-i*a)/2):"Contain entire picture, keep aspect ratio"===e?((l=t/o)>(d=n/i)?(r=d,a=d):(r=l,a=l),s=(t-o*r)/2,c=(n-i*a)/2):"Cover entire area with entire picture"===e?(s=0,c=0,r=t/o,a=n/i):(r=1,a=1,s=(t-o)/2,c=(n-i)/2),{scale_x:r,scale_y:a,offset_x:s,offset_y:c}}}}(n(0))},61:function(e,t,n){var o=n(44),i=o.valueOrCacheValue,r=o.replaceParamsBySessionLink,a=n(54);e.exports=function(e,t,n,o,s){function c(o,c){var l=e.getParameters();delete l.design,delete l.content,delete l.translation,s.isEmbeddedLTIAuthenticated()&&(l.lti_authenticated=1);var d=n.getProviderId(),u=window.location.protocol+"//"+window.location.host+window.location.pathname+r(window.location.search);if(null==l.login_hint&&d&&""!==d&&(window.location.search.length>1?u+="&":u+="?",u+="login_hint="+encodeURIComponent(d)),u+=e.getHash(),""===o||"?"===o.charAt(0))return t.showAlert("The widget is not included.","Broken link"),o;function p(e){return-1===e.indexOf("?")?"?":"&"}if(c&&(o+=p(o)+"backlink="+encodeURIComponent(u),window.bwbackbuttonlabel&&(o+="&backbutton="+encodeURIComponent(window.bwbackbuttonlabel))),o.indexOf("/play/")>=0)l.q&&""!==l.q&&(o+=p(o)+function(e,t){if(null==e)return"";var n=a.isArray(t)?t:[t];return a.filter(e.split("&"),function(e){for(var t=0;t<n.length;++t)if(e.startsWith(n[t]+"="))return!1;return!0}).join("&")}(i(l.q),["context_id","backlink","backbutton"])),null!=l.toplevel&&(o+=p(o)+"toplevel="+encodeURIComponent(l.toplevel)),d&&""!==d&&(o+=p(o)+"login_hint="+encodeURIComponent(d));else{var f={},h={};for(var g in l)"sid"!==g&&l.hasOwnProperty(g)&&(e.LEGACY_HASH_PARAMETERS.indexOf(g)>=0?f[g]=l[g]:h[g]=l[g]);d&&""!==d&&(f.login_hint=d),Object.keys(h).length>0&&(o+=p(o)+e.urlencode(h)),Object.keys(f).length>0&&(o+="#"+e.urlencode(f))}return o}function l(e,t,n){if(console.log("Widget link: "+e),e=c(e,t),n){var i=o(n.target),r=0===i.length?{left:0,top:0}:i.offset(),a=i.clone();o("body").append(a),a.css({position:"absolute",left:r.left+"px",top:r.top+"px",width:i.width()+"px",height:i.height()+"px","border-left":i.css("border-left"),"border-right":i.css("border-right"),"border-top":i.css("border-top"),"border-bottom":i.css("border-bottom"),"border-top-left-radius":i.css("border-top-left-radius"),"border-top-right-radius":i.css("border-top-right-radius"),"border-bottom-left-radius":i.css("border-bottom-left-radius"),"border-bottom-right-radius":i.css("border-bottom-right-radius"),"-webkit-border-top-left-radius":i.css("-webkit-border-top-left-radius"),"-webkit-border-top-right-radius":i.css("-webkit-border-top-right-radius"),"-webkit-border-bottom-left-radius":i.css("-webkit-border-bottom-left-radius"),"-webkit-border-bottom-right-radius":i.css("-webkit-border-bottom-right-radius"),"box-shadow":i.css("box-shadow"),"-webkit-box-shadow":i.css("-webkit-box-shadow")});a.css({"-webkit-transition":"all .5s linear","-moz-transition":"all .5s linear","-o-transition":"all .5s linear",transition:"all .5s linear","box-sizing":"border-box"});var s=o(document).width(),l=o(document).height(),d=s/i.width(),u=l/i.height(),p=d>u?u:d,f="translate("+(s/2-r.left-i.width()/2)+"px, "+(l/2-r.top-i.height()/2)+"px) scale("+p+")";a.css({"-webkit-transform":f,"-moz-transform":f,"-o-transform":f,transform:f,opacity:.1}),setTimeout(function(){window.location=e},500),i.closest("span[onclick]").attr("onclick","")}else window.location=e}function d(e){return null!=e&&-1!==e.indexOf("bookwidgets.com/play/")}return{isWidgetPlayLink:d,openLinkOrWidgetLink:function(e,t){if(d(e)){var n=-1===e.indexOf("?")?"?":"&";l(e+=n+"noiframe=1",t)}else o().isSafeURLForNavigation(e)&&(console.log("open link"),top.location.href=e)},processRichTextWidgetPlayLinks:function(e,t){e.find("a").filter(function(){return d(o(this).attr("href"))}).each(function(){var e=o(this),n=e.attr("href");console.log("make link widget play link",n);var i=-1===n.indexOf("?")?"?":"&";n+=i+"noiframe=1",e.before(o(document.createElement("div")).css("display","inline-block").tapOrClick(function(){return l(n,t),!1}).safeHtml(e.html())),e.after("&nbsp;"),e.hide()})},openWidget:l,addLinkIcon:function(e){o(document.createElement("div")).addClass("link-icon").css({width:"24px",height:"24px",position:"absolute",top:"10px",right:"10px",opacity:"0.6",background:"url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAYAAACqaXHeAAAAAXNSR0IArs4c6QAAA+JJREFUeAHlm8tLIzEcx2Nb67M3wZsXb7uw91UPHv0f/AdEEEEEUUQQRBBE0a4PfKJWEV+IiIgUEfHmraxXBa/e3NvCbjbf2oiPTZv5zWRm0gn8GoyTmXw+ySTttGHsc/oqiqZF3Il4FsEtDzCABUxgU6ak+E9axB8RtkOr2g82MIL1XUJBVoSqYrmVg/WdhB8RgpediZHAKkTgvsiJiImIUvorYL/FxcuQiO9RIi+wovN/4wUz5JdCYdSyOwjAMpGKGnmB9xcEYFKIbEpQyJubm1ljY6NW1YoKOKYnav1cLseenzG4Sye5LGjnTU1N/P7+noc5tbW1afGQlr7Hx0fW3t7OHh4eSusN+REkAWAqFwlkAeUiwZWAcpDgWoDtEjwRYLMEzwTYKsFTATZK8FyAbRKMCLBJgjEBtkgwKsAGCcYFhF2CLwLeSnh6esKfxpP4pKp1Dd8EoDUdHR2soaFBq2F+HeSbgK6uLra4uMioDzhMCfFFQHd3N5ufnw8dPKQaF9DT08Pm5uZCCW9cQG9vL5udnTU1ej07r9azM3E1R8f19fUF+siwtbVVt73OwHRE9Pf3BwqPiwcmYGBgIHD4wAQMDg6GAj4QAcPDw6GB913AyMiI5/C3t7dcfO9APq9vc8Do6Ci5kaqKNzc3PJVKcTffQPkiYGxsTMVALr++vub19fWvSxhVgnEB4+PjZEhVxaurK15XV/cKL5dcigSjAiYmJlQM5PLLy0teW1v7CZ4qwZiAyclJMqSqYjabLQpPkdDS0qKUKc9XyPXfCU5NTakYyOUXFxe8pqZGt7HaE6PnAmZmZsiQqorn5+e8urpaG172nM6c4KmAdDqtYiCXn52d8aqqKsfwuhI8ESCe3nDxWZ4Mqap4enrqCl5HgmsBgBePsFQM5PKTkxOeTCbJPS/hZa66HVwJAPzS0hIZUlXx+PjYU/hiElwJ6OzsVDGQy4+OjnhlZaVnPS/hZf5xJLgS4PXwPzg44IlEwhj8/yS4EoATQsLy8jK5x2XFvb09X+A/SnAtQEpYXV2VLI7z3d1dHo/Hjfe8hJc5bgfxY07d6xZ/JxiLxfj6+rpj+O3t7UDgpQQHeXEBOBEkbG5uakvY2tqyBR6jpLQAKSGTyZSUsLGxkReme94QHKcnAA3F/byzs6OUsLa2Zhu8/giQPQUJmNw+ppWVlfzKIY+zKHe+NxBr+v7+/qsDvGvEsmkRtGxr/vf02DIjC7RzSDg8POQLCwu2woP1p4j8jkpt8LeyIMHSnpe809jOEeltcxgBSJHdOPmC/7KNNNJbZyECe2kxEiK5eRoCZMKcEJnt8/8AtqIJGXRoCukAAAAASUVORK5CYII=)","background-size":"cover"}).appendTo(e)},widgetCoverImage:function(e){return e?e.replace("/play/","/cover/"):null}}}(n(8),n(21),n(100),n(0),n(55))},62:function(e,t,n){function o(e){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var i,r,a,s,c=n(83).adjustRichTextVideoSize;e.exports=(i=n(2),r=n(0),a=n(56),s={getParameterByNameRaw:function(e,t){t=t.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var n=new RegExp("[\\?&]"+t+"=([^&#]*)").exec(e);return null===n?"":n[1].replace(/\+/g," ")},isYoutubeUrl:function(e){var t=e.match(/^.*(youtu.be\/|v\/|u\/\w\/|embed\/|watch\?v=)([^#\&\?]*).*/);return!(!t||11!==t[2].length)},getYoutubeId:function(e){var t=e.match(/^.*(youtu.be\/|v\/|u\/\w\/|embed\/|watch\?v=)([^#\&\?]*).*/);if(t&&11===t[2].length)return console.log("Youtube id: ",t[2]),t[2];var n=s.getParameterByNameRaw(e,"v");return""!==n?(console.log("Youtube id: ",n),n):(console.log("Youtube id: ",e),e)},timeToSeconds:function(e){var t=e.match(/(([0-9]+)m)?([0-9]+)s/);if(null==t)return 0;var n=parseInt(t[3]);return t[2]&&(n+=60*parseInt(t[2])),n},getYoutubeStart:function(e){var t=s.getParameterByNameRaw(e,"start");if(""!==t)return console.log("Start: ",t),parseInt(t);var n=s.getParameterByNameRaw(e,"t");return""!==n?(console.log("Start: ",s.timeToSeconds(n)),s.timeToSeconds(n)):0},getYoutubeEnd:function(e){var t=s.getParameterByNameRaw(e,"end");return""!==t?(console.log("End: ",t),parseInt(t)):0},getInterval:function(e){var t="",n=s.getYoutubeStart(e);0!==n&&(t="?start="+n);var o=s.getYoutubeEnd(e);return 0!==o&&(t+=""===t?"?":"&",t+="end="+o),console.log("Interval: ",t),t},addPlayerIFrame:function(e,t){var n=r(e);if("ibw-platform-win32-preview"===i.getPlatform()||"ibw-platform-osx-preview"===i.getPlatform())return n.safeHtml("<br>Youtube videos are not supported in preview mode."),void n.css({"background-color":"black",color:"white","text-weight":"bold","text-align":"center"});var o=a("http://www.youtube.com/embed/")+s.getYoutubeId(t)+s.getInterval(t);console.log("iframe url: ",o),r(document.createElement("iframe")).attr({seamless:"",id:"playeriframe",src:o}).appendTo(n)},youtubeplaceholdercounter:0,resolveYoutubePlaceholdersNew:function(e){e.find(".youtubeplaceholder").each(function(){var e=r(this);if(void 0===e.attr("id")){console.log("prepare movie player");var t="YTP_"+s.youtubeplaceholdercounter++;e.attr("id",t);var n=e.attr("src");s.addPlayerIFrame("#"+t,n)}})},YouTubeLoading:!1,YouTubeVideos:[],loadYouTubePlayer:function(e,t,n){var o=document.createElement("script");o.setAttribute("type","text/javascript"),o.setAttribute("src",a("http://www.youtube.com/player_api")),document.getElementsByTagName("body")[0].appendChild(o)},pollStartVideos:function(){if(console.log("pollStartVideos()"),void 0!==window.YT&&void 0!==window.YT.Player){console.log("YT player ready, really playing");for(var e=0;e<s.YouTubeVideos.length;++e)s.YouTubeVideos[e]()}else setTimeout(s.pollStartVideos,100)},playYouTube:function(e,t){var n=s.getYoutubeId(t),a=s.getYoutubeStart(t),c=s.getYoutubeEnd(t);if("ibw-platform-win32-preview"===i.getPlatform()||"ibw-platform-osx-preview"===i.getPlatform()){var l=r(e);return l.safeHtml("<br>Youtube videos are not supported in preview mode."),void l.css({"background-color":"black",color:"white","text-weight":"bold","text-align":"center"})}function d(){console.log("createYouTubeVideo() "+e+" "+n+" "+a+" "+c);var t=r(e),i={rel:0};0!==a&&(i.start=a),0!==c&&(i.end=c),console.log(o(window.YT.Player)),new window.YT.Player(e.substring(1),{height:t.height(),width:t.width(),videoId:n,playerVars:i})}void 0!==window.YT&&void 0!==window.YT.Player?d():(s.YouTubeVideos.push(d),s.YouTubeLoading||(s.YouTubeLoading="true",s.loadYouTubePlayer(),setTimeout(s.pollStartVideos,100)))},createHtml5VideoPlayer:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"video/mp4",i=r(document.createElement("video")).attr({controls:"",preload:"auto",poster:""});return null!=t&&i.attr("width",t),null!=n&&i.attr("height",n),r(document.createElement("source")).attr({src:e,type:o}).appendTo(i),i},resolveYoutubePlaceholders:function(e){function t(e,t){var n=t.width(),o=t.height(),i=r(document.createElement("div")).addClass("videodiv").css({width:n,height:o}).appendTo(t);return r(document.createElement("iframe")).attr({frameborder:"0",webkitAllowFullScreen:"",mozallowfullscreen:"",allowFullScreen:""}).css({width:n,height:o}).appendTo(i).attr("src",e),i}e.find(".youtubeplaceholder").each(function(){var e=r(this);if(void 0===e.attr("id")){console.log("prepare movie player");var n="YTP_"+s.youtubeplaceholdercounter++;e.attr("id",n);var o=e.attr("src");c(e),!function(e){return-1!==e.toLowerCase().indexOf("youtu")}(o)?function(e){return-1!==e.toLowerCase().indexOf("vimeo")}(o)?function(e,n){t(a("http://player.vimeo.com/video")+"/"+function(e){var t=e.match(/.*\/(.+)\??.*/);return t?t[1]:e}(e),n).addClass("bw-vimeo-wrapper")}(o,r("#"+n)):function(e){return-1!==e.toLowerCase().indexOf("giphy")}(o)?function(e,n){t(a("http://giphy.com/embed")+"/"+function(e){var t=e.match(/.*\/(.+)\??.*/);return t?t[1]:e}(e),n).addClass("bw-giphy-wrapper")}(o,r("#"+n)):console.error("Unsupported video URL: "+o):s.playYouTube("#"+n,o)}})}})},7:function(e,t,n){function o(e){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var i=n(143).default;e.exports=function(e,t){var n={},r=t.Deferred();function a(e){return function e(n,i){if("string"==typeof n)return n.replace(/\$RESOURCEDIR/g,i);if(t.isArray(n)){for(var r=[],a=0;a<n.length;++a)r.push(e(n[a],i));return r}if("object"===o(n)){var s={};for(var c in n)n.hasOwnProperty(c)&&(s[c]=e(n[c],i));return s}return n}(e,(n="",0===window.location.pathname.indexOf("/_ah/gcs/bookwidgets-eu--widgets/")?n=window.location.origin+"/_ah/gcs/bookwidgets-eu--widget-assets":"widgets-eu.bookwidgets.com"===window.location.host&&(n="//widget-assets-eu.bookwidgets.com"),n));var n}return i().then(function(i){var s=function(e){var n=function e(n){if("string"==typeof n)return function(e){for(var t="",n=0;n<e.length;++n)2*n<e.length?t+=e.charAt(2*n):t+=e.charAt(2*(e.length-n)-1);return t}(n);if(t.isArray(n)){for(var i=[],r=0;r<n.length;++r)i.push(e(n[r]));return i}if("object"===o(n)){var a={};for(var s in n)n.hasOwnProperty(s)&&(a[s]=e(n[s]));return a}return n}(e);return n=a(n)}(i);for(var c in s)n[c]=s[c];e(n),r.resolve(n)}),{fixResourcePaths:a,getConfig:function(){return r},getConfigSync:function(){return n}}}(n(149),n(0))},8:function(e,t){e.exports=function(){var e=["context_id","course_id","hide_account","lfq","lti","login_hint","no_logout","q","sso","smartschool_platform","student_class_id","submit_url","teacher_email","teacher_id"];function t(e){var t=[];if("[object Array]"===Object.prototype.toString.call(e))for(var n=0;n<e.length;++n){var o=e[n];o.length>1?t.push(encodeURIComponent(o[0])+"="+encodeURIComponent(o[1])):t.push(encodeURIComponent(o[0]))}else for(var i in e)e.hasOwnProperty(i)&&t.push(encodeURIComponent(i)+"="+encodeURIComponent(e[i]));return t.join("&")}function n(e){for(var t={},n=e.split("&"),o=0;o<n.length;o++){var i=n[o].indexOf("=");if(!(i<0)){var r=[n[o].substr(0,i),n[o].substr(i+1)],a=decodeURIComponent(r[0]);if(void 0===t[a])t[a]=decodeURIComponent(r[1]);else if("string"==typeof t[a]){var s=[t[a],decodeURIComponent(r[1])];t[a]=s}else t[a].push(decodeURIComponent(r[1]))}}return t}function o(e){for(var t=[],n=e.split("&"),o=0;o<n.length;o++){var i=n[o].indexOf("=");if(i<0)t.push([n[o]]);else{var r=[n[o].substr(0,i),n[o].substr(i+1)];t.push([decodeURIComponent(r[0]),decodeURIComponent(r[1])])}}return t}function i(e){return!e||e.length<1||"?"!==e[0]?{}:n(e.substr(1))}function r(e){return!e||e.length<1||"?"!==e[0]?[]:o(e.substr(1))}function a(e,t){return e.split("&").filter(function(e){return decodeURIComponent(e.split("=")[0])!==t}).join("&")}function s(e){return(e=e||window.location.href).indexOf("#")>=0?"#"+(e.split("#")[1]||""):""}!function(){var n=r(window.location.search),i=[],a=s();if(a.length>=1&&"#"===a[0])for(var c=o(a.substr(1)),l=0;l<c.length;++l){var d=c[l];e.indexOf(d[0])>=0?n.push(d):i.push(d)}var u=window.location.pathname;n.length>0&&(u+="?"+t(n)),i.length>0&&(u+="#"+t(i)),"undefined"!=typeof history&&history.replaceState("",document.title,u)}();var c=s(),l=window.location.search;return{split:n,splitList:o,getUrlParams:function(e){return-1===e.indexOf("?")?{}:n(e.replace(/[^\?]*\?/,"").replace(/#.*/,""))},getQueryParams:i,getParameters:function(){var e=i(l),t=function(e){return!e||e.length<1||"#"!==e[0]?{}:n(e.substr(1))}(c);for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o]);return e},removeQueryStringParameter:function(e,t){return e.length>0&&("?"===e[0]||"#"===e[0])?e[0]+a(e.substring(1),t):a(e,t)},updateWindowQueryParameter:function(e,n){for(var o=r(window.location.search),i=!1,a=0;a<o.length;++a)if(o[a][0]===e){o[a].length>1?o[a][1]=n:o[a].push(n),i=!0;break}i||o.push([e,n]),history.replaceState("",document.title,window.location.pathname+"?"+t(o)+s())},urlencode:t,getHash:s,LEGACY_HASH_PARAMETERS:e}}()},83:function(e,t,n){"use strict";n.r(t),n.d(t,"adjustRichTextVideoSize",function(){return c}),n.d(t,"process",function(){return l});var o=n(60),i=n(61),r=n(0),a=n.n(r),s=(n(236),n(235).processEmbeddedIframes);function c(e){"0px"===e.css("width")&&null===e.css("float")||"none"===e.css("float")?e.css({width:"640px",height:"400px","max-width":"90%"}):e.css({width:"320px",height:"240px"})}function l(e){e.addClass("bw-richtext"),o.processRichTextImages(e),i.processRichTextWidgetPlayLinks(e,!0),function(e){e.find("video").each(function(){c(a()(this))})}(e),function(e){e.find("a.rtlink").attr("target","_top")}(e),function(e){e.find(".iframeplaceholder").each(function(){var e=a()(this),t=e.attr("src");e.replaceWith(a()(document.createElement("iframe")).addClass("rt-iframe").attr("src",t))})}(e),s(e.find(".rt-iframe")),function(e){e.find("table").addClass("bw-richtext-table")}(e)}}});